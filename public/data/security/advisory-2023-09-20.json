{
  "title": "Jenkins Security Advisory 2023-09-20",
  "date": "2023-09-20",
  "url": "/security/advisory/2023-09-20/",
  "kind": "core and plugin",
  "core": {
    "lts": {
      "previous": "2.414.1",
      "fixed": "2.414.2"
    },
    "weekly": {
      "previous": "2.423",
      "fixed": "2.424"
    }
  },
  "issues": [
    {
      "id": "SECURITY-3261",
      "reporter": "sunita",
      "title": "Builds can be filtered by values of sensitive build variables",
      "cve": "CVE-2023-43494",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "Jenkins allows filtering builds in the build history widget by specifying an expression that searches for matching builds by name, description, parameter values, etc.\n\nJenkins 2.50 through 2.423 (both inclusive), LTS 2.60.1 through 2.414.1 (both inclusive) does not exclude sensitive build variables (e.g., password parameter values) from this search.\n\nThis allows attackers with Item/Read permission to obtain values of sensitive variables used in builds by iteratively testing different characters until the correct sequence is discovered.\n\nJenkins 2.424, LTS 2.414.2 excludes sensitive variables from this search.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins allows filtering builds in the build history widget by specifying an expression that searches for matching builds by name, description, parameter values, etc.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.50 through 2.423 (both inclusive), LTS 2.60.1 through 2.414.1 (both inclusive) does not exclude sensitive build variables (e.g., password parameter values) from this search.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Item/Read permission to obtain values of sensitive variables used in builds by iteratively testing different characters until the correct sequence is discovered.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.424, LTS 2.414.2 excludes sensitive variables from this search.</p>\n</div>"
    },
    {
      "id": "SECURITY-3245",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc.",
      "title": "Stored XSS vulnerability",
      "cve": "CVE-2023-43495",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "`ExpandableDetailsNote` allows annotating build log content with additional information that can be revealed when interacted with.\n\nJenkins 2.423 and earlier, LTS 2.414.1 and earlier does not escape the value of the `caption` constructor parameter of `ExpandableDetailsNote`.\n\nThis results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide `caption` parameter values.\n\nNOTE: As of publication, the related API is not used within Jenkins (core), and the Jenkins security team is not aware of any affected plugins.\n\nJenkins 2.424, LTS 2.414.2 escapes `caption` constructor parameter values.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p><code>ExpandableDetailsNote</code> allows annotating build log content with additional information that can be revealed when interacted with.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.423 and earlier, LTS 2.414.1 and earlier does not escape the value of the <code>caption</code> constructor parameter of <code>ExpandableDetailsNote</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide <code>caption</code> parameter values.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nAs of publication, the related API is not used within Jenkins (core), and the Jenkins security team is not aware of any affected plugins.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.424, LTS 2.414.2 escapes <code>caption</code> constructor parameter values.</p>\n</div>"
    },
    {
      "id": "SECURITY-3072",
      "reporter": "Daniel Beck, CloudBees, Inc.",
      "title": "Temporary plugin file created with insecure permissions",
      "cve": "CVE-2023-43496",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins creates a temporary file when a plugin is deployed directly from a URL.\n\nJenkins 2.423 and earlier, LTS 2.414.1 and earlier creates this temporary file in the system temporary directory with the default permissions for newly created files.\n\nIf these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is installed in Jenkins, potentially resulting in arbitrary code execution.\n\nIMPORTANT: This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.\n\nNOTE: This issue complements link:/security/advisory/2023-03-08/#SECURITY-2823[SECURITY-2823], which affected plugins uploaded from an administrator's computer.\n\nJenkins 2.424, LTS 2.414.2 creates the temporary file in a subdirectory with more restrictive permissions.\n\nAs a workaround, you can change your default temporary-file directory using the Java system property `java.io.tmpdir`, if you're concerned about this issue but unable to immediately update Jenkins.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins creates a temporary file when a plugin is deployed directly from a URL.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.423 and earlier, LTS 2.414.1 and earlier creates this temporary file in the system temporary directory with the default permissions for newly created files.</p>\n</div>\n<div class=\"paragraph\">\n<p>If these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is installed in Jenkins, potentially resulting in arbitrary code execution.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nThis vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThis issue complements <a href=\"/security/advisory/2023-03-08/#SECURITY-2823\">SECURITY-2823</a>, which affected plugins uploaded from an administrator&#8217;s computer.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.424, LTS 2.414.2 creates the temporary file in a subdirectory with more restrictive permissions.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround, you can change your default temporary-file directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>\n</div>"
    },
    {
      "id": "SECURITY-3073",
      "reporter": "Daniel Beck, CloudBees, Inc.",
      "title": "Temporary uploaded file created with insecure permissions",
      "cve": "CVE-2023-43497 (Stapler), CVE-2023-43498 (MultipartFormDataParser)",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "In Jenkins 2.423 and earlier, LTS 2.414.1 and earlier, uploaded files processed via the Stapler web framework and the Jenkins API `MultipartFormDataParser` create temporary files in the system temporary directory with the default permissions for newly created files.\n\nIf these permissions are overly permissive, attackers with access to the system temporary directory may be able to read and write the file before it is used.\n\nIMPORTANT: This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.\n\nJenkins 2.424, LTS 2.414.2 creates the temporary files in a subdirectory with more restrictive permissions.\n\nAs a workaround, you can change your default temporary-file directory using the Java system property `java.io.tmpdir`, if you're concerned about this issue but unable to immediately update Jenkins.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>In Jenkins 2.423 and earlier, LTS 2.414.1 and earlier, uploaded files processed via the Stapler web framework and the Jenkins API <code>MultipartFormDataParser</code> create temporary files in the system temporary directory with the default permissions for newly created files.</p>\n</div>\n<div class=\"paragraph\">\n<p>If these permissions are overly permissive, attackers with access to the system temporary directory may be able to read and write the file before it is used.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nThis vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.424, LTS 2.414.2 creates the temporary files in a subdirectory with more restrictive permissions.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround, you can change your default temporary-file directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>\n</div>"
    },
    {
      "id": "SECURITY-3244",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc.",
      "title": "Stored XSS vulnerability in PLUGIN_NAME",
      "cve": "CVE-2023-43499",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "PLUGIN_NAME 2.4.1 and earlier does not escape Failure Cause names in build logs.\n\nThis results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to create or update Failure Causes.\n\nPLUGIN_NAME 2.4.2 escapes Failure Cause names in build logs.",
      "plugins": [
        {
          "name": "build-failure-analyzer",
          "title": "Build Failure Analyzer",
          "previous": "2.4.1",
          "fixed": "2.4.2"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not escape Failure Cause names in build logs.</p>\n</div>\n<div class=\"paragraph\">\n<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to create or update Failure Causes.</p>\n</div>\n<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.2 escapes Failure Cause names in build logs.</p>\n</div>"
    },
    {
      "id": "SECURITY-3226",
      "reporter": "Andrea Chiera, CloudBees, Inc.",
      "title": "CSRF vulnerability and missing permission check in PLUGIN_NAME allow SSRF",
      "cve": "CVE-2023-43500 (CSRF), CVE-2023-43501 (missing permission check)",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 2.4.1 and earlier does not perform a permission check in a connection test HTTP endpoint.\n\nThis allows attackers with Overall/Read permission to connect to an attacker-specified hostname and port using attacker-specified username and password.\n\nAdditionally, this HTTP endpoint does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.\n\nPLUGIN_NAME 2.4.2 requires POST requests and Overall/Administer permission for the affected HTTP endpoint.",
      "plugins": [
        {
          "name": "build-failure-analyzer",
          "title": "Build Failure Analyzer",
          "previous": "2.4.1",
          "fixed": "2.4.2"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not perform a permission check in a connection test HTTP endpoint.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Overall/Read permission to connect to an attacker-specified hostname and port using attacker-specified username and password.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, this HTTP endpoint does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>\n</div>\n<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.2 requires POST requests and Overall/Administer permission for the affected HTTP endpoint.</p>\n</div>"
    },
    {
      "id": "SECURITY-3239",
      "reporter": "Andrea Chiera, CloudBees, Inc.",
      "title": "CSRF vulnerability in PLUGIN_NAME allows deleting Failure Causes",
      "cve": "CVE-2023-43502",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 2.4.1 and earlier does not require POST requests for an HTTP endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.\n\nThis vulnerability allows attackers to delete Failure Causes.\n\nPLUGIN_NAME 2.4.2 requires POST requests for the affected HTTP endpoint.",
      "plugins": [
        {
          "name": "build-failure-analyzer",
          "title": "Build Failure Analyzer",
          "previous": "2.4.1",
          "fixed": "2.4.2"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not require POST requests for an HTTP endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.</p>\n</div>\n<div class=\"paragraph\">\n<p>This vulnerability allows attackers to delete Failure Causes.</p>\n</div>\n<div class=\"paragraph\">\n<p>Build Failure Analyzer Plugin 2.4.2 requires POST requests for the affected HTTP endpoint.</p>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}