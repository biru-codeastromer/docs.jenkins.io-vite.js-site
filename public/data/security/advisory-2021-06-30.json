{
  "title": "Jenkins Security Advisory 2021-06-30",
  "date": "2021-06-30",
  "url": "/security/advisory/2021-06-30/",
  "kind": "core and plugins",
  "core": {
    "lts": {
      "previous": "2.289.1",
      "fixed": "2.289.2"
    },
    "weekly": {
      "previous": "2.299",
      "fixed": "2.300"
    }
  },
  "issues": [
    {
      "id": "SECURITY-2278",
      "reporter": "Ang√©lique Jard, CloudBees, Inc.",
      "title": "Improper permission checks allow canceling queue items and aborting builds",
      "cve": "CVE-2021-21670",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "Jenkins 2.299 and earlier, LTS 2.289.1 and earlier allows users to cancel queue items and abort builds of jobs for which they have Item/Cancel permission even when they do not have Item/Read permission.\n\nJenkins 2.300, LTS 2.289.2 requires that users have Item/Read permission for applicable types in addition to Item/Cancel permission.\n\nAs a workaround on earlier versions of Jenkins, do not grant Item/Cancel permission to users who do not have Item/Read permission.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins 2.299 and earlier, LTS 2.289.1 and earlier allows users to cancel queue items and abort builds of jobs for which they have Item/Cancel permission even when they do not have Item/Read permission.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.300, LTS 2.289.2 requires that users have Item/Read permission for applicable types in addition to Item/Cancel permission.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround on earlier versions of Jenkins, do not grant Item/Cancel permission to users who do not have Item/Read permission.</p>\n</div>"
    },
    {
      "id": "SECURITY-2371",
      "reporter": null,
      "title": "Session fixation vulnerability",
      "cve": "CVE-2021-21671",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins 2.299 and earlier, LTS 2.289.1 and earlier does not invalidate the existing session on login.\nThis allows attackers to use social engineering techniques to gain administrator access to Jenkins.\n\nThis vulnerability was introduced in Jenkins 2.266 and LTS 2.277.1.\n\nJenkins 2.300, LTS 2.289.2 invalidates the existing session on login.\n\nNOTE: In case of problems, administrators can choose a different implementation by setting the link:/doc/book/managing/system-properties/#hudson-security-securityrealm-sessionfixationprotectionmode[Java system property `hudson.security.SecurityRealm.sessionFixationProtectionMode`] to `2`, or disable the fix entirely by setting that system property to `0`.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins 2.299 and earlier, LTS 2.289.1 and earlier does not invalidate the existing session on login.\nThis allows attackers to use social engineering techniques to gain administrator access to Jenkins.</p>\n</div>\n<div class=\"paragraph\">\n<p>This vulnerability was introduced in Jenkins 2.266 and LTS 2.277.1.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.300, LTS 2.289.2 invalidates the existing session on login.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nIn case of problems, administrators can choose a different implementation by setting the <a href=\"/doc/book/managing/system-properties/#hudson-security-securityrealm-sessionfixationprotectionmode\">Java system property <code>hudson.security.SecurityRealm.sessionFixationProtectionMode</code></a> to <code>2</code>, or disable the fix entirely by setting that system property to <code>0</code>.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-2329",
      "reporter": "Justin Philip, Kevin Guerroudj, Marc Heyries",
      "title": "XXE vulnerability in PLUGIN_NAME",
      "cve": "CVE-2021-21672",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 1.0 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.\n\nThis allows attackers with the ability to control the report files parsed using this plugin to have Jenkins parse a crafted report file that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.\n\nPLUGIN_NAME 1.1 disables external entity resolution for its XML parser.",
      "plugins": [
        {
          "name": "seleniumhtmlreport",
          "title": "Selenium HTML report",
          "previous": "1.0",
          "fixed": "1.1"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Selenium HTML report Plugin 1.0 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with the ability to control the report files parsed using this plugin to have Jenkins parse a crafted report file that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.</p>\n</div>\n<div class=\"paragraph\">\n<p>Selenium HTML report Plugin 1.1 disables external entity resolution for its XML parser.</p>\n</div>"
    },
    {
      "id": "SECURITY-2387",
      "reporter": "Wadeck Follonier, CloudBees, Inc.",
      "title": "Open redirect vulnerability in PLUGIN_NAME",
      "cve": "CVE-2021-21673",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 1.6.0 and earlier improperly determines that a redirect URL after login is legitimately pointing to Jenkins.\n\nThis allows attackers to perform phishing attacks by having users go to a Jenkins URL that will forward them to a different site after successful authentication.\n\nPLUGIN_NAME 1.6.1 only redirects to relative (Jenkins) URLs.",
      "plugins": [
        {
          "name": "cas-plugin",
          "title": "CAS",
          "previous": "1.6.0",
          "fixed": "1.6.1"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>CAS Plugin 1.6.0 and earlier improperly determines that a redirect URL after login is legitimately pointing to Jenkins.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers to perform phishing attacks by having users go to a Jenkins URL that will forward them to a different site after successful authentication.</p>\n</div>\n<div class=\"paragraph\">\n<p>CAS Plugin 1.6.1 only redirects to relative (Jenkins) URLs.</p>\n</div>"
    },
    {
      "id": "SECURITY-1995",
      "reporter": "Matt Sicker, CloudBees, Inc.",
      "title": "Missing permission check in PLUGIN_NAME allows viewing pending requests",
      "cve": "CVE-2021-21674",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME 2.2.6 and earlier does not perform a permission check in an HTTP endpoint.\n\nThis allows attackers with Overall/Read permission to view the list of pending requests.\n\nPLUGIN_NAME 2.2.7 requires Overall/Administer permission to view the list of pending requests.\n\nNOTE: The previous sentence originally stated that Overall/Read permission was newly required. This statement was incorrect and has been fixed on 2021-07-05.",
      "plugins": [
        {
          "name": "requests",
          "title": "requests-plugin",
          "previous": "2.2.6",
          "fixed": "2.2.7"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.6 and earlier does not perform a permission check in an HTTP endpoint.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Overall/Read permission to view the list of pending requests.</p>\n</div>\n<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.7 requires Overall/Administer permission to view the list of pending requests.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThe previous sentence originally stated that Overall/Read permission was newly required. This statement was incorrect and has been fixed on 2021-07-05.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-2136 (1)",
      "reporter": null,
      "title": "CSRF vulnerabilities in PLUGIN_NAME",
      "cve": "CVE-2021-21675",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"
      },
      "description_adoc": "PLUGIN_NAME 2.2.12 and earlier does not require POST requests to request and apply changes, resulting in cross-site request forgery (CSRF) vulnerabilities.\n\nThese vulnerabilities allow attackers to create requests and/or have administrators apply pending requests, like renaming or deleting jobs, deleting builds, etc.\n\nPLUGIN_NAME 2.2.13 requires POST requests for the affected HTTP endpoints.\n\nThis was partially fixed in PLUGIN_NAME 2.2.8 to require POST requests for some of the affected HTTP endpoints, but the endpoint allowing administrators to apply pending requests remained unprotected until 2.2.13.",
      "plugins": [
        {
          "name": "requests",
          "title": "requests-plugin",
          "previous": "2.2.12",
          "fixed": "2.2.13"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.12 and earlier does not require POST requests to request and apply changes, resulting in cross-site request forgery (CSRF) vulnerabilities.</p>\n</div>\n<div class=\"paragraph\">\n<p>These vulnerabilities allow attackers to create requests and/or have administrators apply pending requests, like renaming or deleting jobs, deleting builds, etc.</p>\n</div>\n<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.13 requires POST requests for the affected HTTP endpoints.</p>\n</div>\n<div class=\"paragraph\">\n<p>This was partially fixed in requests-plugin Plugin 2.2.8 to require POST requests for some of the affected HTTP endpoints, but the endpoint allowing administrators to apply pending requests remained unprotected until 2.2.13.</p>\n</div>"
    },
    {
      "id": "SECURITY-2136 (2)",
      "reporter": null,
      "title": "Missing permission check in PLUGIN_NAME allows sending emails",
      "cve": "CVE-2021-21676",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 2.2.7 and earlier does not perform a permission check in an HTTP endpoint.\n\nThis allows attackers with Overall/Read permission to send test emails to an attacker-specified email address.\n\nPLUGIN_NAME 2.2.8 requires Overall/Administer permission to send test emails.",
      "plugins": [
        {
          "name": "requests",
          "title": "requests-plugin",
          "previous": "2.2.7",
          "fixed": "2.2.8"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.7 and earlier does not perform a permission check in an HTTP endpoint.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Overall/Read permission to send test emails to an attacker-specified email address.</p>\n</div>\n<div class=\"paragraph\">\n<p>requests-plugin Plugin 2.2.8 requires Overall/Administer permission to send test emails.</p>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}