{
  "title": "Jenkins Security Advisory 2019-11-21",
  "date": "2019-11-21",
  "url": "/security/advisory/2019-11-21/",
  "kind": "plugins",
  "core": null,
  "issues": [
    {
      "id": "SECURITY-1658",
      "reporter": "Nils Emmerich of ERNW Research GmbH",
      "title": "Sandbox bypass vulnerability in PLUGIN_NAME",
      "cve": "CVE-2019-16538",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Sandbox protection in PLUGIN_NAME could be circumvented through closure default parameter expressions.\n\nThis allowed attackers able to specify and run sandboxed scripts to execute arbitrary code in the context of the Jenkins controller JVM.\n\nThese expressions are now subject to sandbox protection.",
      "plugins": [
        {
          "name": "script-security",
          "title": "Script Security",
          "previous": "1.67",
          "fixed": "1.68"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Sandbox protection in Script Security Plugin could be circumvented through closure default parameter expressions.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allowed attackers able to specify and run sandboxed scripts to execute arbitrary code in the context of the Jenkins controller JVM.</p>\n</div>\n<div class=\"paragraph\">\n<p>These expressions are now subject to sandbox protection.</p>\n</div>"
    },
    {
      "id": "SECURITY-1634",
      "reporter": "Daniel Beck, CloudBees, Inc.",
      "title": "PLUGIN_NAME allowed users with Overall/Read permission to delete arbitrary files",
      "cve": "CVE-2019-16539 (permission check), CVE-2019-16540 (path traversal)",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:L"
      },
      "description_adoc": "PLUGIN_NAME did not validate the paths submitted for the \"Delete Support Bundles\" feature.\nThis allowed users to delete arbitrary files on the Jenkins controller file system accessible to the OS user account running Jenkins.\n\nAdditionally, this endpoint did not perform a permission check, allowing users with Overall/Read permission to delete support bundles, and any arbitrary other file, with a known name/path.\n\nPLUGIN_NAME now only allows the deletion of support bundles and related files listed on the UI through this feature.\nIt also ensures that only users with \"Download Bundle\" permission are able to delete support bundles.",
      "plugins": [
        {
          "name": "support-core",
          "title": "Support Core",
          "previous": "2.63",
          "fixed": "2.64"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Support Core Plugin did not validate the paths submitted for the \"Delete Support Bundles\" feature.\nThis allowed users to delete arbitrary files on the Jenkins controller file system accessible to the OS user account running Jenkins.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, this endpoint did not perform a permission check, allowing users with Overall/Read permission to delete support bundles, and any arbitrary other file, with a known name/path.</p>\n</div>\n<div class=\"paragraph\">\n<p>Support Core Plugin now only allows the deletion of support bundles and related files listed on the UI through this feature.\nIt also ensures that only users with \"Download Bundle\" permission are able to delete support bundles.</p>\n</div>"
    },
    {
      "id": "SECURITY-1106",
      "reporter": "Daniel Beck, CloudBees, Inc.",
      "title": "Folder-scoped Jira sites in PLUGIN_NAME were able to access System-scoped credentials",
      "cve": "CVE-2019-16541",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME allows the definition of per-folder Jira sites.\n\nThe credentials lookup for this feature did not set the appropriate context, allowing the use of System-scoped credentials otherwise reserved for use in the global configuration.\nThis allowed users with Item/Configure permission on the folder to access credentials they're not entitled to, and potentially capture them.\n\nPLUGIN_NAME now defines the appropriate folder context for credential lookup.\nAs a side effect, existing per-folder Jira sites may lose access to already configured System-scoped credentials, as if no credential was specified in the first place.",
      "plugins": [
        {
          "name": "jira",
          "title": "Jira",
          "previous": "3.0.10",
          "fixed": "3.0.11"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jira Plugin allows the definition of per-folder Jira sites.</p>\n</div>\n<div class=\"paragraph\">\n<p>The credentials lookup for this feature did not set the appropriate context, allowing the use of System-scoped credentials otherwise reserved for use in the global configuration.\nThis allowed users with Item/Configure permission on the folder to access credentials they&#8217;re not entitled to, and potentially capture them.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jira Plugin now defines the appropriate folder context for credential lookup.\nAs a side effect, existing per-folder Jira sites may lose access to already configured System-scoped credentials, as if no credential was specified in the first place.</p>\n</div>"
    },
    {
      "id": "SECURITY-1539",
      "reporter": "James Holderness, IB Boost",
      "title": "PLUGIN_NAME stored credentials in plain text",
      "cve": "CVE-2019-16542",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stored an Anchore.io service password unencrypted in job `config.xml` files as part of its configuration.\nThis credential could be viewed by users with Extended Read permission or access to the Jenkins controller file system.\n\nAs the affected functionality has been deprecated, and the affected Anchore.io service has been shut down in late 2018, the affected feature has been removed.\nThe password will be removed from the job configuration once it is saved again.",
      "plugins": [
        {
          "name": "anchore-container-scanner",
          "title": "Anchore Container Image Scanner",
          "previous": "1.0.19",
          "fixed": "1.0.20"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Anchore Container Image Scanner Plugin stored an Anchore.io service password unencrypted in job <code>config.xml</code> files as part of its configuration.\nThis credential could be viewed by users with Extended Read permission or access to the Jenkins controller file system.</p>\n</div>\n<div class=\"paragraph\">\n<p>As the affected functionality has been deprecated, and the affected Anchore.io service has been shut down in late 2018, the affected feature has been removed.\nThe password will be removed from the job configuration once it is saved again.</p>\n</div>"
    },
    {
      "id": "SECURITY-1554",
      "reporter": "James Holderness, IB Boost",
      "title": "PLUGIN_NAME stored credentials in plain text",
      "cve": "CVE-2019-16543",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stored a credential unencrypted in its global configuration file `com.inflectra.spiratest.plugins.SpiraBuilder.xml` on the Jenkins controller.\nThis credential could be viewed by users with access to the Jenkins controller file system.\n\nPLUGIN_NAME now stores this credential encrypted once its configuration is saved again.",
      "plugins": [
        {
          "name": "inflectra-spira-integration",
          "title": "Spira Importer",
          "previous": "3.2.2",
          "fixed": "3.2.3"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Spira Importer Plugin stored a credential unencrypted in its global configuration file <code>com.inflectra.spiratest.plugins.SpiraBuilder.xml</code> on the Jenkins controller.\nThis credential could be viewed by users with access to the Jenkins controller file system.</p>\n</div>\n<div class=\"paragraph\">\n<p>Spira Importer Plugin now stores this credential encrypted once its configuration is saved again.</p>\n</div>"
    },
    {
      "id": "SECURITY-1584",
      "reporter": "Matt Sicker, CloudBees, Inc.",
      "title": "PLUGIN_NAME did not verify SSH host keys",
      "cve": "CVE-2019-16546",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N"
      },
      "description_adoc": "PLUGIN_NAME did not use SSH host key verification when connecting to VMs launched by the plugin.\nThis lack of verification could be abused by a MitM attacker to intercept these connections to attacker-specified build agents without warning.\n\nPLUGIN_NAME now verifies SSH host keys before executing any commands on agents.",
      "plugins": [
        {
          "name": "google-compute-engine",
          "title": "Google Compute Engine",
          "previous": "4.1.1",
          "fixed": "4.2.0"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Google Compute Engine Plugin did not use SSH host key verification when connecting to VMs launched by the plugin.\nThis lack of verification could be abused by a MitM attacker to intercept these connections to attacker-specified build agents without warning.</p>\n</div>\n<div class=\"paragraph\">\n<p>Google Compute Engine Plugin now verifies SSH host keys before executing any commands on agents.</p>\n</div>"
    },
    {
      "id": "SECURITY-1585",
      "reporter": "Matt Sicker, CloudBees, Inc.",
      "title": "PLUGIN_NAME disclosed environment information to users with Overall/Read permission",
      "cve": "CVE-2019-16547",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME did not verify permissions on multiple auto-complete API endpoints.\nThis allowed users with Overall/Read permissions to view various metadata about the running cloud environment.\n\nPLUGIN_NAME now requires the appropriate Job/Configure permission to view these metadata.",
      "plugins": [
        {
          "name": "google-compute-engine",
          "title": "Google Compute Engine",
          "previous": "4.1.1",
          "fixed": "4.2.0"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Google Compute Engine Plugin did not verify permissions on multiple auto-complete API endpoints.\nThis allowed users with Overall/Read permissions to view various metadata about the running cloud environment.</p>\n</div>\n<div class=\"paragraph\">\n<p>Google Compute Engine Plugin now requires the appropriate Job/Configure permission to view these metadata.</p>\n</div>"
    },
    {
      "id": "SECURITY-1586",
      "reporter": "Matt Sicker, CloudBees, Inc.",
      "title": "CSRF vulnerability in PLUGIN_NAME allowed provisioning agents",
      "cve": "CVE-2019-16548",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L"
      },
      "description_adoc": "PLUGIN_NAME did not require POST requests on an API endpoint.\nThis CSRF vulnerability allowed attackers to provision new agents.\n\nPLUGIN_NAME now requires POST requests for this API endpoint.",
      "plugins": [
        {
          "name": "google-compute-engine",
          "title": "Google Compute Engine",
          "previous": "4.1.1",
          "fixed": "4.2.0"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Google Compute Engine Plugin did not require POST requests on an API endpoint.\nThis CSRF vulnerability allowed attackers to provision new agents.</p>\n</div>\n<div class=\"paragraph\">\n<p>Google Compute Engine Plugin now requires POST requests for this API endpoint.</p>\n</div>"
    },
    {
      "id": "SECURITY-727 (1)",
      "reporter": null,
      "title": "PLUGIN_NAME stored credentials in plain text",
      "cve": "CVE-2019-16544",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stored credentials unencrypted in job `config.xml` files on the Jenkins controller as part of its post-build step configuration.\nThis credential could be viewed by users with Extended Read permission or access to the Jenkins controller file system.\n\nPLUGIN_NAME now stores these credentials encrypted once the job configuration is saved again.",
      "plugins": [
        {
          "name": "qmetry-for-jira-test-management",
          "title": "QMetry for JIRA - Test Management",
          "previous": "1.12",
          "fixed": "1.13"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>QMetry for JIRA - Test Management Plugin stored credentials unencrypted in job <code>config.xml</code> files on the Jenkins controller as part of its post-build step configuration.\nThis credential could be viewed by users with Extended Read permission or access to the Jenkins controller file system.</p>\n</div>\n<div class=\"paragraph\">\n<p>QMetry for JIRA - Test Management Plugin now stores these credentials encrypted once the job configuration is saved again.</p>\n</div>"
    },
    {
      "id": "SECURITY-727 (2)",
      "reporter": null,
      "title": "PLUGIN_NAME shows plain text password in configuration form",
      "cve": "CVE-2019-16545",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stores a credential as part of its post-build step configuration.\n\nWhile the password is stored encrypted on disk since PLUGIN_NAME 1.13, it is transmitted in plain text as part of the configuration form.\nThis can result in exposure of the password through browser extensions, cross-site scripting vulnerabilities, and similar situations.\n\nAs of publication of this advisory, there is no fix.",
      "plugins": [
        {
          "name": "qmetry-for-jira-test-management",
          "title": "QMetry for JIRA - Test Management",
          "previous": "1.13",
          "fixed": null
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>QMetry for JIRA - Test Management Plugin stores a credential as part of its post-build step configuration.</p>\n</div>\n<div class=\"paragraph\">\n<p>While the password is stored encrypted on disk since QMetry for JIRA - Test Management Plugin 1.13, it is transmitted in plain text as part of the configuration form.\nThis can result in exposure of the password through browser extensions, cross-site scripting vulnerabilities, and similar situations.</p>\n</div>\n<div class=\"paragraph\">\n<p>As of publication of this advisory, there is no fix.</p>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}