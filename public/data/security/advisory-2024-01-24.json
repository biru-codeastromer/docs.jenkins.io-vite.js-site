{
  "title": "Jenkins Security Advisory 2024-01-24",
  "date": "2024-01-24",
  "url": "/security/advisory/2024-01-24/",
  "kind": "core and plugins",
  "core": {
    "lts": {
      "previous": "2.426.2",
      "fixed": "2.426.3 or 2.440.1"
    },
    "weekly": {
      "previous": "2.441",
      "fixed": "2.442"
    }
  },
  "issues": [
    {
      "id": "SECURITY-3314",
      "reporter": "Yaniv Nizry (SonarSource)",
      "title": "Arbitrary file read vulnerability through the CLI can lead to RCE",
      "cve": "CVE-2024-23897",
      "cvss": {
        "severity": "Critical",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins has a built-in link:/doc/book/managing/cli/[command line interface (CLI)] to access Jenkins from a script or shell environment.\n\nJenkins uses the https://github.com/kohsuke/args4j[args4j library] to parse command arguments and options on the Jenkins controller when processing CLI commands.\nThis command parser has a feature that replaces an `@` character followed by a file path in an argument with the file's contents (`expandAtFiles`).\nThis feature is enabled by default and Jenkins 2.441 and earlier, LTS 2.426.2 and earlier does not disable it.\n\nThis allows attackers to read arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.\n\n* Attackers with Overall/Read permission can read entire files.\n* Attackers *without* Overall/Read permission can read the first few lines of files.\n  The number of lines that can be read depends on available CLI commands.\n  As of publication of this advisory, the Jenkins security team has found ways to read the first three lines of files in recent releases of Jenkins without having any plugins installed, and has not identified any plugins that would increase this line count.\n\nBinary files containing cryptographic keys used for various Jenkins features can also be read, with some limitations (see link:#binary-files-note[note on binary files below]).\nAs of publication, the Jenkins security team has confirmed the following possible attacks in addition to reading contents of all files with a known file path.\nAll of them leverage attackers' ability to obtain cryptographic keys from binary files, and are therefore only applicable to instances where that is feasible.\n\nWARNING: This list is not definitive.\nFurther attacks likely exist, including ones that do not need attackers to obtain cryptographic keys from binary files.\n\n* **Remote code execution via Resource Root URLs** (Variant 1) +\n  Exploitation requires that all of the following conditions are met:\n  ** The \"Resource Root URL\" functionality is enabled (see link:/doc/book/security/user-content/#resource-root-url[documentation]).\n  ** The CLI WebSocket endpoint is accessible.\n     This requires that Jenkins is running on a version of Jetty for which Jenkins supports WebSockets.\n     This is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command `java -jar jenkins.war`.\n     Additionally, reverse proxies may not allow WebSocket requests if improperly configured.\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** Attackers know, or can guess, the user name of any user with Overall/Read permission.\n* **Remote code execution via Resource Root URLs** (Variant 2) +\n  Exploitation requires that all of the following conditions are met:\n  ** The \"Resource Root URL\" functionality is enabled (see link:/doc/book/security/user-content/#resource-root-url[documentation]).\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** The attacker needs an API token for a (non-anonymous) user account.\n     It is not necessary for this user account to (still) have Overall/Read permission.\n* **Remote code execution via \"Remember me\" cookie** +\n  Forging a \"Remember me\" cookie allows attackers to log in to Jenkins using a web browser, thereby gaining access to the Script Console if they forge a cookie for an administrator account.\n  Exploitation requires that all of the following conditions are met:\n  ** The \"Remember me\" feature is enabled (the default).\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** Attackers have Overall/Read permission to be able to read content in files beyond the first few lines.\n* **Remote code execution via stored cross-site scripting (XSS) attacks through build logs** +\n  Forging serialized console note objects allows implementing XSS attacks by injecting arbitrary HTML and JavaScript into build logs.\n  This attack bypasses the protections added for link:/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-console-notes[SECURITY-382 in the 2017-02-01 security advisory].\n  Exploitation requires that all of the following conditions are met:\n  ** Attackers can control build log output (e.g., through pull requests).\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n* **Remote code execution via CSRF protection bypass** +\n  Forged CSRF tokens (\"crumbs\") can be used to implement CSRF attacks by sending POST requests with a valid crumb.\n  Exploitation requires that all of the following conditions are met:\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** The web session ID is not part of CSRF crumbs.\n     By default it is (see link:/security/advisory/2019-07-17/#SECURITY-626[SECURITY-626 in the 2019-07-17 security advisory]), but not if one of the following conditions is met:\n     *** Jenkins uses the default crumb issuer and the link:/doc/book/managing/system-properties/#hudson-security-csrf-defaultcrumbissuer-exclude_session_id[Java system property `hudson.security.csrf.DefaultCrumbIssuer.EXCLUDE_SESSION_ID`] is set to `true`.\n     *** Jenkins uses the https://plugins.jenkins.io/strict-crumb-issuer/[Strict Crumb Issuer Plugin] to generate crumbs and the option \"Check the session ID\" is unchecked.\n* **Decrypt secrets stored in Jenkins** +\n  Jenkins typically uses secrets to access other systems, like SCMs, external user directories for security realms, cloud providers, deployment targets, etc.\n  Exploitation requires that all of the following conditions are met:\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** Attackers have access to encrypted secrets.\n     This may require Overall/Read permission, to be able to read content in files beyond the first few lines, but there are other possible sources, like `JENKINS_HOME` backups even if they exclude `secrets/`, or https://plugins.jenkins.io/configuration-as-code/[Configuration as Code] YAML files.\n* **Delete any item in Jenkins** +\n  Exploitation requires that all of the following conditions are met:\n  ** The \"Resource Root URL\" functionality is enabled (see link:/doc/book/security/user-content/#resource-root-url[documentation]).\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** Attackers know, or can guess, the user name of any user with Overall/Read permission.\n* **Download a Java heap dump** of the Jenkins controller process or any agent process +\n  Exploitation requires that all of the following conditions are met:\n  ** The \"Resource Root URL\" functionality is enabled (see link:/doc/book/security/user-content/#resource-root-url[documentation]).\n  ** Attackers can retrieve binary secrets (see link:#binary-files-note[note below]).\n  ** Attackers know, or can guess, the user name of any user with Overall/Read permission.\n  ** The Jenkins controller or agent process is running on a Java runtime that allows the creation of heap dump files without `.hprof` file extension.\n     Due to https://issues.jenkins.io/browse/JENKINS-72579[JENKINS-72579] the affected feature does not work by default on recent releases of OpenJDK/HotSpot based JVMs.\n\n.Impact of reading arbitrary files\n[NOTE]\n====\nWe have previously considered arbitrary file read vulnerabilities to only have an impact on confidentiality.\nAs a result of the report provided by Yaniv Nizry (SonarSource) and the additional research done by the Jenkins security team resulting in the list above, future vulnerabilities of this kind will likewise be considered to have a high score across all impact metrics (confidentiality, integrity, and availability).\n====\n\n[#binary-files-note]\n.Limitations for reading binary files\n[IMPORTANT]\n====\nWhile files containing binary data can be read, the affected feature attempts to read them as strings using the controller process's default character encoding.\nThis is likely to result in some bytes not being read successfully and being replaced with a placeholder value.\nWhich bytes can or cannot be read depends on this character encoding.\nFor example, attempting to read random binary data using UTF-8, roughly half of all bytes will be replaced with a placeholder for an illegal value.\nFor 32 byte random binary secrets, as commonly used in Jenkins for https://en.wikipedia.org/wiki/HMAC[HMAC-SHA256], this would require attackers to correctly guess on average 16 bytes, which is infeasible.\nIn contrast, with the encoding Windows-1252, only 5 out of 256 possible values are illegal and would be replaced with a placeholder.\nThis is a significantly lower number of bytes to guess in a binary secret on average, as well as fewer possible options for each byte.\n\nTelemetry submissions received from Jenkins 2.437 and later indicate that more than 90% of Jenkins instances reporting anonymous usage statistics use UTF-8 as default character encoding.\nAlmost all instances running on Linux and Mac OS X use UTF-8.\nInstances on Windows are more likely than not to use a character set that makes it feasible to implement exploits involving reading binary files (like Windows-1252).\n\nTo determine whether you're likely affected by the most severe impacts described above, check the value of the `file.encoding` system property in _Manage Jenkins » System Information_.\n\nIMPORTANT: While it is _unlikely_ that randomly generated keys use significantly fewer than average of the byte values that cannot be read using a character encoding like UTF-8, it isn't _impossible_.\nTherefore administrators should update Jenkins in a timely manner, regardless of the value of `file.encoding`.\n====\n\n**Fix Description:** +\nJenkins 2.442, LTS 2.426.3, and LTS 2.440.1 disables the command parser feature that replaces an `@` character followed by a file path in an argument with the file's contents for CLI commands.\n\nIn case of problems with this fix, disable this change by setting the link:/doc/book/managing/system-properties/#hudson-cli-clicommand-allowatsyntax[Java system property `hudson.cli.CLICommand.allowAtSyntax`] to `true`.\nDoing this is strongly discouraged on any network accessible by users who are not Jenkins administrators.\n\n**Workaround:** +\nDisabling access to the CLI is expected to prevent exploitation completely.\nDoing so is strongly recommended to administrators unable to immediately update to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1.\nApplying this workaround does not require a Jenkins restart.\nFor instructions, see the link:https://github.com/jenkinsci-cert/SECURITY-3314-3315/[documentation for this workaround].\n\nNOTE: Disabling the CLI is only intended as a short-term workaround, even if you do not use the CLI.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins has a built-in <a href=\"/doc/book/managing/cli/\">command line interface (CLI)</a> to access Jenkins from a script or shell environment.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins uses the <a href=\"https://github.com/kohsuke/args4j\">args4j library</a> to parse command arguments and options on the Jenkins controller when processing CLI commands.\nThis command parser has a feature that replaces an <code>@</code> character followed by a file path in an argument with the file&#8217;s contents (<code>expandAtFiles</code>).\nThis feature is enabled by default and Jenkins 2.441 and earlier, LTS 2.426.2 and earlier does not disable it.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers to read arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Attackers with Overall/Read permission can read entire files.</p>\n</li>\n<li>\n<p>Attackers <strong>without</strong> Overall/Read permission can read the first few lines of files.\nThe number of lines that can be read depends on available CLI commands.\nAs of publication of this advisory, the Jenkins security team has found ways to read the first three lines of files in recent releases of Jenkins without having any plugins installed, and has not identified any plugins that would increase this line count.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Binary files containing cryptographic keys used for various Jenkins features can also be read, with some limitations (see <a href=\"#binary-files-note\">note on binary files below</a>).\nAs of publication, the Jenkins security team has confirmed the following possible attacks in addition to reading contents of all files with a known file path.\nAll of them leverage attackers' ability to obtain cryptographic keys from binary files, and are therefore only applicable to instances where that is feasible.</p>\n</div>\n<div class=\"admonitionblock warning\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-warning\" title=\"Warning\"></i>\n</td>\n<td class=\"content\">\nThis list is not definitive.\nFurther attacks likely exist, including ones that do not need attackers to obtain cryptographic keys from binary files.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><strong>Remote code execution via Resource Root URLs</strong> (Variant 1)<br>\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The \"Resource Root URL\" functionality is enabled (see <a href=\"/doc/book/security/user-content/#resource-root-url\">documentation</a>).</p>\n</li>\n<li>\n<p>The CLI WebSocket endpoint is accessible.\nThis requires that Jenkins is running on a version of Jetty for which Jenkins supports WebSockets.\nThis is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command <code>java -jar jenkins.war</code>.\nAdditionally, reverse proxies may not allow WebSocket requests if improperly configured.</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>Attackers know, or can guess, the user name of any user with Overall/Read permission.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Remote code execution via Resource Root URLs</strong> (Variant 2)<br>\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The \"Resource Root URL\" functionality is enabled (see <a href=\"/doc/book/security/user-content/#resource-root-url\">documentation</a>).</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>The attacker needs an API token for a (non-anonymous) user account.\nIt is not necessary for this user account to (still) have Overall/Read permission.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Remote code execution via \"Remember me\" cookie</strong><br>\nForging a \"Remember me\" cookie allows attackers to log in to Jenkins using a web browser, thereby gaining access to the Script Console if they forge a cookie for an administrator account.\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The \"Remember me\" feature is enabled (the default).</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>Attackers have Overall/Read permission to be able to read content in files beyond the first few lines.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Remote code execution via stored cross-site scripting (XSS) attacks through build logs</strong><br>\nForging serialized console note objects allows implementing XSS attacks by injecting arbitrary HTML and JavaScript into build logs.\nThis attack bypasses the protections added for <a href=\"/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-console-notes\">SECURITY-382 in the 2017-02-01 security advisory</a>.\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Attackers can control build log output (e.g., through pull requests).</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Remote code execution via CSRF protection bypass</strong><br>\nForged CSRF tokens (\"crumbs\") can be used to implement CSRF attacks by sending POST requests with a valid crumb.\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>The web session ID is not part of CSRF crumbs.\nBy default it is (see <a href=\"/security/advisory/2019-07-17/#SECURITY-626\">SECURITY-626 in the 2019-07-17 security advisory</a>), but not if one of the following conditions is met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Jenkins uses the default crumb issuer and the <a href=\"/doc/book/managing/system-properties/#hudson-security-csrf-defaultcrumbissuer-exclude_session_id\">Java system property <code>hudson.security.csrf.DefaultCrumbIssuer.EXCLUDE_SESSION_ID</code></a> is set to <code>true</code>.</p>\n</li>\n<li>\n<p>Jenkins uses the <a href=\"https://plugins.jenkins.io/strict-crumb-issuer/\">Strict Crumb Issuer Plugin</a> to generate crumbs and the option \"Check the session ID\" is unchecked.</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Decrypt secrets stored in Jenkins</strong><br>\nJenkins typically uses secrets to access other systems, like SCMs, external user directories for security realms, cloud providers, deployment targets, etc.\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>Attackers have access to encrypted secrets.\nThis may require Overall/Read permission, to be able to read content in files beyond the first few lines, but there are other possible sources, like <code>JENKINS_HOME</code> backups even if they exclude <code>secrets/</code>, or <a href=\"https://plugins.jenkins.io/configuration-as-code/\">Configuration as Code</a> YAML files.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Delete any item in Jenkins</strong><br>\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The \"Resource Root URL\" functionality is enabled (see <a href=\"/doc/book/security/user-content/#resource-root-url\">documentation</a>).</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>Attackers know, or can guess, the user name of any user with Overall/Read permission.</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><strong>Download a Java heap dump</strong> of the Jenkins controller process or any agent process<br>\nExploitation requires that all of the following conditions are met:</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The \"Resource Root URL\" functionality is enabled (see <a href=\"/doc/book/security/user-content/#resource-root-url\">documentation</a>).</p>\n</li>\n<li>\n<p>Attackers can retrieve binary secrets (see <a href=\"#binary-files-note\">note below</a>).</p>\n</li>\n<li>\n<p>Attackers know, or can guess, the user name of any user with Overall/Read permission.</p>\n</li>\n<li>\n<p>The Jenkins controller or agent process is running on a Java runtime that allows the creation of heap dump files without <code>.hprof</code> file extension.\nDue to <a href=\"https://issues.jenkins.io/browse/JENKINS-72579\">JENKINS-72579</a> the affected feature does not work by default on recent releases of OpenJDK/HotSpot based JVMs.</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">Impact of reading arbitrary files</div>\n<div class=\"paragraph\">\n<p>We have previously considered arbitrary file read vulnerabilities to only have an impact on confidentiality.\nAs a result of the report provided by Yaniv Nizry (SonarSource) and the additional research done by the Jenkins security team resulting in the list above, future vulnerabilities of this kind will likewise be considered to have a high score across all impact metrics (confidentiality, integrity, and availability).</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div id=\"binary-files-note\" class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\n<div class=\"title\">Limitations for reading binary files</div>\n<div class=\"paragraph\">\n<p>While files containing binary data can be read, the affected feature attempts to read them as strings using the controller process&#8217;s default character encoding.\nThis is likely to result in some bytes not being read successfully and being replaced with a placeholder value.\nWhich bytes can or cannot be read depends on this character encoding.\nFor example, attempting to read random binary data using UTF-8, roughly half of all bytes will be replaced with a placeholder for an illegal value.\nFor 32 byte random binary secrets, as commonly used in Jenkins for <a href=\"https://en.wikipedia.org/wiki/HMAC\">HMAC-SHA256</a>, this would require attackers to correctly guess on average 16 bytes, which is infeasible.\nIn contrast, with the encoding Windows-1252, only 5 out of 256 possible values are illegal and would be replaced with a placeholder.\nThis is a significantly lower number of bytes to guess in a binary secret on average, as well as fewer possible options for each byte.</p>\n</div>\n<div class=\"paragraph\">\n<p>Telemetry submissions received from Jenkins 2.437 and later indicate that more than 90% of Jenkins instances reporting anonymous usage statistics use UTF-8 as default character encoding.\nAlmost all instances running on Linux and Mac OS X use UTF-8.\nInstances on Windows are more likely than not to use a character set that makes it feasible to implement exploits involving reading binary files (like Windows-1252).</p>\n</div>\n<div class=\"paragraph\">\n<p>To determine whether you&#8217;re likely affected by the most severe impacts described above, check the value of the <code>file.encoding</code> system property in <em>Manage Jenkins » System Information</em>.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nWhile it is <em>unlikely</em> that randomly generated keys use significantly fewer than average of the byte values that cannot be read using a character encoding like UTF-8, it isn&#8217;t <em>impossible</em>.\nTherefore administrators should update Jenkins in a timely manner, regardless of the value of <code>file.encoding</code>.\n</td>\n</tr>\n</table>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p><strong>Fix Description:</strong><br>\nJenkins 2.442, LTS 2.426.3, and LTS 2.440.1 disables the command parser feature that replaces an <code>@</code> character followed by a file path in an argument with the file&#8217;s contents for CLI commands.</p>\n</div>\n<div class=\"paragraph\">\n<p>In case of problems with this fix, disable this change by setting the <a href=\"/doc/book/managing/system-properties/#hudson-cli-clicommand-allowatsyntax\">Java system property <code>hudson.cli.CLICommand.allowAtSyntax</code></a> to <code>true</code>.\nDoing this is strongly discouraged on any network accessible by users who are not Jenkins administrators.</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Workaround:</strong><br>\nDisabling access to the CLI is expected to prevent exploitation completely.\nDoing so is strongly recommended to administrators unable to immediately update to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1.\nApplying this workaround does not require a Jenkins restart.\nFor instructions, see the <a href=\"https://github.com/jenkinsci-cert/SECURITY-3314-3315/\">documentation for this workaround</a>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nDisabling the CLI is only intended as a short-term workaround, even if you do not use the CLI.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-3315",
      "reporter": "Yaniv Nizry (SonarSource)",
      "title": "Cross-site WebSocket hijacking vulnerability in the CLI",
      "cve": "CVE-2024-23898",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins has a built-in link:/doc/book/managing/cli/[command line interface (CLI)] to access Jenkins from a script or shell environment.\nSince Jenkins 2.217 and LTS 2.222.1, one of the ways to communicate with the CLI is through a WebSocket endpoint.\nThis endpoint relies on the default Jenkins web request authentication functionality, like HTTP Basic authentication with API tokens, or session cookies.\nThis endpoint is enabled when running on a version of Jetty for which Jenkins supports WebSockets.\nThis is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command `java -jar jenkins.war`.\n\nJenkins 2.217 through 2.441 (both inclusive), LTS 2.222.1 through 2.426.2 (both inclusive) does not perform origin validation of requests made through the CLI WebSocket endpoint, resulting in a cross-site WebSocket hijacking (CSWSH) vulnerability.\n\nAdditionally, Jenkins does not set an explicit `SameSite` attribute for session cookies.\nThis can allow cross-site requests to make use of the session cookie, i.e., those requests are sent with the logged-in user's authentication.\n\n[NOTE]\n====\nIn recent releases of Google Chrome and Microsoft Edge the default behavior is for the `SameSite` cookie attribute to be considered `Lax` if not explicitly set.\nThis results in no session cookie being sent with a cross-site request to the WebSocket endpoint, resulting in CLI use as the anonymous user.\nMozilla Firefox has an option for this behavior, but it is disabled by default as of publication of this advisory.\nSee https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#browser_compatibility[this browser compatibility table] (row labeled _Defaults to_ `_Lax_`) for details.\n====\n\nThis vulnerability allows attackers to execute CLI commands on the Jenkins controller.\nThe impact depends on the permissions of the anonymous user and/or the browser(s) used by the victim(s) of the CSWSH attack:\n\n* **The anonymous user has no permissions and Jenkins users use web browsers with `SameSite` cookie attribute `Lax` as default** +\n  Attackers can execute the `who-am-i` CLI command, obtaining limited information about the anonymous user in Jenkins.\n  This mostly allows exploiting link:#SECURITY-3314[SECURITY-3314] and reading the first few lines of files on the Jenkins controller.\n  See that issue for more information about the potential impact.\n* **The anonymous user has permissions** +\n  This is the case with an authorization strategy like \"Anyone can do anything\", or when the anonymous user has explicitly been granted additional permissions.\n  Attackers can execute the CLI commands that these permissions allow using, up to and including Groovy scripting capabilities (`groovy` and `groovysh` commands) resulting in arbitrary code execution.\n  If the anonymous user has (only) Overall/Read permission, attackers can obtain the full contents of files by exploiting link:#SECURITY-3314[SECURITY-3314] as described in that issue.\n* **Jenkins users use web browsers with `SameSite` cookie attribute `Lax` not being the default** +\n  The session and/or \"Remember me\" cookie will be sent with the cross-site request, and the user will be authenticated.\n  Attackers can execute the CLI commands that the victim's permissions allow using, up to and including Groovy scripting capabilities (`groovy` and `groovysh` commands) in case of a Jenkins administrator, resulting in arbitrary code execution.\n\n**Fix Description:** +\nJenkins 2.442, LTS 2.426.3, and LTS 2.440.1 performs origin validation of requests made through the CLI WebSocket endpoint.\n\nIn case of problems with this fix, disable this change by setting the link:/doc/book/managing/system-properties/#hudson-cli-cliaction-allow_websocket[Java system property `hudson.cli.CLIAction.ALLOW_WEBSOCKET`] to `true`.\n\n**Workaround:** +\nSome workarounds are available to mitigate some or all of the impact if you are unable to immediately upgrade to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1:\n\n* **Disable CLI access** +\n  Disabling access to the CLI will prevent exploitation completely and is the **recommended workaround** for administrators unable to immediately update.\n  Applying this workaround does not require a Jenkins restart.\n  For instructions, see the link:https://github.com/jenkinsci-cert/SECURITY-3314-3315/[documentation for this workaround].\n* **Prevent WebSocket access using a reverse proxy** +\n  If Jenkins is accessible only through a reverse proxy, configure that proxy to prevent access to the CLI via WebSocket by not upgrading requests.\n\n[NOTE]\n====\nAdministrators of Jenkins instances accessed through a reverse proxy can follow the instructions below to test whether WebSocket endpoints can be reached.\nThese instructions assume that the reverse proxy is not set up to support only selected WebSocket endpoints (e.g., only the CLI).\n\n. Log in to Jenkins as a user with Overall/Administer permission.\n. Open your web browser's developer tools while viewing the Jenkins dashboard.\n. On the _Console_ tab, paste the following script:\n\n[source,javascript]\n----\nnew WebSocket(document.location.toString().replace('http', 'ws') + 'wsecho/')\n----\n\nOn the _Network_ tab, if the `wsecho/` request resulted in a `101 Switching Protocols` response, WebSocket endpoints can be accessed.\nA `400 Bad Request` response, or lack of response (in Google Chrome), indicates that WebSocket endpoints cannot be accessed.\nA `403 Forbidden` response indicates that the necessary Overall/Administer permission is missing.\n\nThese steps have been validated in Google Chrome, Mozilla Firefox, and Apple Safari.\n====",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins has a built-in <a href=\"/doc/book/managing/cli/\">command line interface (CLI)</a> to access Jenkins from a script or shell environment.\nSince Jenkins 2.217 and LTS 2.222.1, one of the ways to communicate with the CLI is through a WebSocket endpoint.\nThis endpoint relies on the default Jenkins web request authentication functionality, like HTTP Basic authentication with API tokens, or session cookies.\nThis endpoint is enabled when running on a version of Jetty for which Jenkins supports WebSockets.\nThis is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command <code>java -jar jenkins.war</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.217 through 2.441 (both inclusive), LTS 2.222.1 through 2.426.2 (both inclusive) does not perform origin validation of requests made through the CLI WebSocket endpoint, resulting in a cross-site WebSocket hijacking (CSWSH) vulnerability.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, Jenkins does not set an explicit <code>SameSite</code> attribute for session cookies.\nThis can allow cross-site requests to make use of the session cookie, i.e., those requests are sent with the logged-in user&#8217;s authentication.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>In recent releases of Google Chrome and Microsoft Edge the default behavior is for the <code>SameSite</code> cookie attribute to be considered <code>Lax</code> if not explicitly set.\nThis results in no session cookie being sent with a cross-site request to the WebSocket endpoint, resulting in CLI use as the anonymous user.\nMozilla Firefox has an option for this behavior, but it is disabled by default as of publication of this advisory.\nSee <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#browser_compatibility\">this browser compatibility table</a> (row labeled <em>Defaults to</em> <code><em>Lax</em></code>) for details.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>This vulnerability allows attackers to execute CLI commands on the Jenkins controller.\nThe impact depends on the permissions of the anonymous user and/or the browser(s) used by the victim(s) of the CSWSH attack:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><strong>The anonymous user has no permissions and Jenkins users use web browsers with <code>SameSite</code> cookie attribute <code>Lax</code> as default</strong><br>\nAttackers can execute the <code>who-am-i</code> CLI command, obtaining limited information about the anonymous user in Jenkins.\nThis mostly allows exploiting <a href=\"#SECURITY-3314\">SECURITY-3314</a> and reading the first few lines of files on the Jenkins controller.\nSee that issue for more information about the potential impact.</p>\n</li>\n<li>\n<p><strong>The anonymous user has permissions</strong><br>\nThis is the case with an authorization strategy like \"Anyone can do anything\", or when the anonymous user has explicitly been granted additional permissions.\nAttackers can execute the CLI commands that these permissions allow using, up to and including Groovy scripting capabilities (<code>groovy</code> and <code>groovysh</code> commands) resulting in arbitrary code execution.\nIf the anonymous user has (only) Overall/Read permission, attackers can obtain the full contents of files by exploiting <a href=\"#SECURITY-3314\">SECURITY-3314</a> as described in that issue.</p>\n</li>\n<li>\n<p><strong>Jenkins users use web browsers with <code>SameSite</code> cookie attribute <code>Lax</code> not being the default</strong><br>\nThe session and/or \"Remember me\" cookie will be sent with the cross-site request, and the user will be authenticated.\nAttackers can execute the CLI commands that the victim&#8217;s permissions allow using, up to and including Groovy scripting capabilities (<code>groovy</code> and <code>groovysh</code> commands) in case of a Jenkins administrator, resulting in arbitrary code execution.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p><strong>Fix Description:</strong><br>\nJenkins 2.442, LTS 2.426.3, and LTS 2.440.1 performs origin validation of requests made through the CLI WebSocket endpoint.</p>\n</div>\n<div class=\"paragraph\">\n<p>In case of problems with this fix, disable this change by setting the <a href=\"/doc/book/managing/system-properties/#hudson-cli-cliaction-allow_websocket\">Java system property <code>hudson.cli.CLIAction.ALLOW_WEBSOCKET</code></a> to <code>true</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Workaround:</strong><br>\nSome workarounds are available to mitigate some or all of the impact if you are unable to immediately upgrade to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><strong>Disable CLI access</strong><br>\nDisabling access to the CLI will prevent exploitation completely and is the <strong>recommended workaround</strong> for administrators unable to immediately update.\nApplying this workaround does not require a Jenkins restart.\nFor instructions, see the <a href=\"https://github.com/jenkinsci-cert/SECURITY-3314-3315/\">documentation for this workaround</a>.</p>\n</li>\n<li>\n<p><strong>Prevent WebSocket access using a reverse proxy</strong><br>\nIf Jenkins is accessible only through a reverse proxy, configure that proxy to prevent access to the CLI via WebSocket by not upgrading requests.</p>\n</li>\n</ul>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>Administrators of Jenkins instances accessed through a reverse proxy can follow the instructions below to test whether WebSocket endpoints can be reached.\nThese instructions assume that the reverse proxy is not set up to support only selected WebSocket endpoints (e.g., only the CLI).</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Log in to Jenkins as a user with Overall/Administer permission.</p>\n</li>\n<li>\n<p>Open your web browser&#8217;s developer tools while viewing the Jenkins dashboard.</p>\n</li>\n<li>\n<p>On the <em>Console</em> tab, paste the following script:</p>\n</li>\n</ol>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"rouge highlight\"><code data-lang=\"javascript\"><span class=\"k\">new</span> <span class=\"nc\">WebSocket</span><span class=\"p\">(</span><span class=\"nb\">document</span><span class=\"p\">.</span><span class=\"nx\">location</span><span class=\"p\">.</span><span class=\"nf\">toString</span><span class=\"p\">().</span><span class=\"nf\">replace</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">http</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">ws</span><span class=\"dl\">'</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"dl\">'</span><span class=\"s1\">wsecho/</span><span class=\"dl\">'</span><span class=\"p\">)</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>On the <em>Network</em> tab, if the <code>wsecho/</code> request resulted in a <code>101 Switching Protocols</code> response, WebSocket endpoints can be accessed.\nA <code>400 Bad Request</code> response, or lack of response (in Google Chrome), indicates that WebSocket endpoints cannot be accessed.\nA <code>403 Forbidden</code> response indicates that the necessary Overall/Administer permission is missing.</p>\n</div>\n<div class=\"paragraph\">\n<p>These steps have been validated in Google Chrome, Mozilla Firefox, and Apple Safari.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-3319",
      "reporter": null,
      "title": "Arbitrary file read vulnerability in PLUGIN_NAME can lead to RCE",
      "cve": "CVE-2024-23899",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "PLUGIN_NAME uses the https://github.com/kohsuke/args4j[args4j library] to parse command arguments and options on the Jenkins controller when processing Git commands received via SSH.\nThis command parser has a feature that replaces an `@` character followed by a file path in an argument with the file's contents (`expandAtFiles`).\nThis feature is enabled by default and PLUGIN_NAME 99.va_0826a_b_cdfa_d and earlier does not disable it.\n\nThis allows attackers with Overall/Read permission to read the first two lines of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.\n\nSee link:#SECURITY-3314[SECURITY-3314] for further information about the potential impact of being able to read files on the Jenkins controller, as well as the link:#binary-files-note[limitations for reading binary files].\nNote that for this issue, unlike SECURITY-3314, attackers need Overall/Read permission.\n\n**Fix Description:** +\nPLUGIN_NAME 99.101.v720e86326c09 disables the command parser feature that replaces an `@` character followed by a file path in an argument with the file's contents for CLI commands.\n\n**Workaround:** +\nNavigate to _Manage Jenkins » Security_ and ensure that the _SSHD Port_ setting in the _SSH Server_ section is set to _Disable_.\nThis disables access to Git repositories hosted by Jenkins (and the Jenkins CLI) via SSH.",
      "plugins": [
        {
          "name": "git-server",
          "title": "Git server",
          "previous": "99.va_0826a_b_cdfa_d",
          "fixed": "99.101.v720e86326c09"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Git server Plugin uses the <a href=\"https://github.com/kohsuke/args4j\">args4j library</a> to parse command arguments and options on the Jenkins controller when processing Git commands received via SSH.\nThis command parser has a feature that replaces an <code>@</code> character followed by a file path in an argument with the file&#8217;s contents (<code>expandAtFiles</code>).\nThis feature is enabled by default and Git server Plugin 99.va_0826a_b_cdfa_d and earlier does not disable it.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Overall/Read permission to read the first two lines of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.</p>\n</div>\n<div class=\"paragraph\">\n<p>See <a href=\"#SECURITY-3314\">SECURITY-3314</a> for further information about the potential impact of being able to read files on the Jenkins controller, as well as the <a href=\"#binary-files-note\">limitations for reading binary files</a>.\nNote that for this issue, unlike SECURITY-3314, attackers need Overall/Read permission.</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Fix Description:</strong><br>\nGit server Plugin 99.101.v720e86326c09 disables the command parser feature that replaces an <code>@</code> character followed by a file path in an argument with the file&#8217;s contents for CLI commands.</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Workaround:</strong><br>\nNavigate to <em>Manage Jenkins » Security</em> and ensure that the <em>SSHD Port</em> setting in the <em>SSH Server</em> section is set to <em>Disable</em>.\nThis disables access to Git repositories hosted by Jenkins (and the Jenkins CLI) via SSH.</p>\n</div>"
    },
    {
      "id": "SECURITY-3289",
      "reporter": "Kevin Guerroudj, CloudBees, Inc.",
      "title": "Path traversal vulnerability in PLUGIN_NAME",
      "cve": "CVE-2024-23900",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L"
      },
      "description_adoc": "PLUGIN_NAME 822.v01b_8c85d16d2 and earlier does not sanitize user-defined axis names of multi-configuration projects submitted through the `config.xml` REST API endpoint.\n\nThis allows attackers with Item/Configure permission to create or replace any `config.xml` file on the Jenkins controller file system with content not controllable by the attackers.\n\nPLUGIN_NAME 822.824.v14451b_c0fd42 sanitizes user-defined axis names of Multi-configuration project.",
      "plugins": [
        {
          "name": "matrix-project",
          "title": "Matrix Project",
          "previous": "822.v01b_8c85d16d2",
          "fixed": "822.824.v14451b_c0fd42"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Matrix Project Plugin 822.v01b_8c85d16d2 and earlier does not sanitize user-defined axis names of multi-configuration projects submitted through the <code>config.xml</code> REST API endpoint.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with Item/Configure permission to create or replace any <code>config.xml</code> file on the Jenkins controller file system with content not controllable by the attackers.</p>\n</div>\n<div class=\"paragraph\">\n<p>Matrix Project Plugin 822.824.v14451b_c0fd42 sanitizes user-defined axis names of Multi-configuration project.</p>\n</div>"
    },
    {
      "id": "SECURITY-3040",
      "reporter": "Francois Marot",
      "title": "Shared projects are unconditionally discovered by PLUGIN_NAME",
      "cve": "CVE-2024-23901",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "GitLab allows sharing a project with another group.\n\nPLUGIN_NAME 684.vea_fa_7c1e2fe3 and earlier unconditionally discovers projects that are shared with the configured owner group.\n\nThis allows attackers to configure and share a project, resulting in a crafted Pipeline being built by Jenkins after the next scan of the group's projects.\n\nIn PLUGIN_NAME 688.v5fa_356ee8520, the default strategy for discovering projects does not discover projects shared with the configured owner group.\nTo discover projects shared with the configured owner group, use the new trait \"Discover shared projects\".\n\nNOTE: After updating, any shared project that has already been discovered will be removed unless the new trait is added to the organization folder configuration before running a scan.",
      "plugins": [
        {
          "name": "gitlab-branch-source",
          "title": "GitLab Branch Source",
          "previous": "684.vea_fa_7c1e2fe3",
          "fixed": "688.v5fa_356ee8520"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>GitLab allows sharing a project with another group.</p>\n</div>\n<div class=\"paragraph\">\n<p>GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier unconditionally discovers projects that are shared with the configured owner group.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers to configure and share a project, resulting in a crafted Pipeline being built by Jenkins after the next scan of the group&#8217;s projects.</p>\n</div>\n<div class=\"paragraph\">\n<p>In GitLab Branch Source Plugin 688.v5fa_356ee8520, the default strategy for discovering projects does not discover projects shared with the configured owner group.\nTo discover projects shared with the configured owner group, use the new trait \"Discover shared projects\".</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nAfter updating, any shared project that has already been discovered will be removed unless the new trait is added to the organization folder configuration before running a scan.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-3251",
      "reporter": "Kevin Guerroudj, CloudBees, Inc.",
      "title": "CSRF vulnerability in PLUGIN_NAME",
      "cve": "CVE-2024-23902",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 684.vea_fa_7c1e2fe3 and earlier does not require POST requests for a form validation endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.\n\nThis vulnerability allows attackers to connect to an attacker-specified URL.\n\nPLUGIN_NAME 688.v5fa_356ee8520 requires POST requests for the affected form validation endpoint.",
      "plugins": [
        {
          "name": "gitlab-branch-source",
          "title": "GitLab Branch Source",
          "previous": "684.vea_fa_7c1e2fe3",
          "fixed": "688.v5fa_356ee8520"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier does not require POST requests for a form validation endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.</p>\n</div>\n<div class=\"paragraph\">\n<p>This vulnerability allows attackers to connect to an attacker-specified URL.</p>\n</div>\n<div class=\"paragraph\">\n<p>GitLab Branch Source Plugin 688.v5fa_356ee8520 requires POST requests for the affected form validation endpoint.</p>\n</div>"
    },
    {
      "id": "SECURITY-2871",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc. and Kevin Guerroudj, CloudBees, Inc.",
      "title": "Non-constant time webhook token comparison in PLUGIN_NAME",
      "cve": "CVE-2024-23903",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME 684.vea_fa_7c1e2fe3 and earlier does not use a constant-time comparison function when checking whether the provided and expected webhook token are equal.\n\nThis could potentially allow attackers to use statistical methods to obtain a valid webhook token.\n\nPLUGIN_NAME 688.v5fa_356ee8520 uses a constant-time comparison function when validating the webhook token.",
      "plugins": [
        {
          "name": "gitlab-branch-source",
          "title": "GitLab Branch Source",
          "previous": "684.vea_fa_7c1e2fe3",
          "fixed": "688.v5fa_356ee8520"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier does not use a constant-time comparison function when checking whether the provided and expected webhook token are equal.</p>\n</div>\n<div class=\"paragraph\">\n<p>This could potentially allow attackers to use statistical methods to obtain a valid webhook token.</p>\n</div>\n<div class=\"paragraph\">\n<p>GitLab Branch Source Plugin 688.v5fa_356ee8520 uses a constant-time comparison function when validating the webhook token.</p>\n</div>"
    },
    {
      "id": "SECURITY-3006",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc.",
      "title": "Stored XSS vulnerability in PLUGIN_NAME",
      "cve": "CVE-2023-6148",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "PLUGIN_NAME 1.0.5 and earlier does not escape Qualys API responses displayed on the job configuration page.\n\nThis results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to configure jobs.\n\nPLUGIN_NAME 1.0.6 escapes Qualys API responses displayed on the job configuration page.",
      "plugins": [
        {
          "name": "qualys-pc",
          "title": "Qualys Policy Compliance Scanning Connector",
          "previous": "1.0.5",
          "fixed": "1.0.6"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not escape Qualys API responses displayed on the job configuration page.</p>\n</div>\n<div class=\"paragraph\">\n<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to configure jobs.</p>\n</div>\n<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.6 escapes Qualys API responses displayed on the job configuration page.</p>\n</div>"
    },
    {
      "id": "SECURITY-3005",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc.",
      "title": "XXE vulnerability in PLUGIN_NAME",
      "cve": "CVE-2023-6147",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 1.0.5 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.\n\nThis allows attackers able to configure jobs to have Jenkins parse a crafted HTTP response with XML data that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.\n\nPLUGIN_NAME 1.0.6 disables external entity resolution for its XML parser.",
      "plugins": [
        {
          "name": "qualys-pc",
          "title": "Qualys Policy Compliance Scanning Connector",
          "previous": "1.0.5",
          "fixed": "1.0.6"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers able to configure jobs to have Jenkins parse a crafted HTTP response with XML data that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.</p>\n</div>\n<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.6 disables external entity resolution for its XML parser.</p>\n</div>"
    },
    {
      "id": "SECURITY-3007",
      "reporter": "Yaroslav Afenkin, CloudBees, Inc.",
      "title": "Incorrect permission checks in PLUGIN_NAME allow capturing credentials",
      "cve": "CVE pending",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME 1.0.5 and earlier does not correctly perform permission checks in several HTTP endpoints.\n\nThis allows attackers with global Item/Configure permission (while lacking Item/Configure permission on any particular job) to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.\n\nPLUGIN_NAME 1.0.6 requires the appropriate permissions for the affected HTTP endpoints.",
      "plugins": [
        {
          "name": "qualys-pc",
          "title": "Qualys Policy Compliance Scanning Connector",
          "previous": "1.0.5",
          "fixed": "1.0.6"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not correctly perform permission checks in several HTTP endpoints.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers with global Item/Configure permission (while lacking Item/Configure permission on any particular job) to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.</p>\n</div>\n<div class=\"paragraph\">\n<p>Qualys Policy Compliance Scanning Connector Plugin 1.0.6 requires the appropriate permissions for the affected HTTP endpoints.</p>\n</div>"
    },
    {
      "id": "SECURITY-3322",
      "reporter": "Pierre Beitz, CloudBees, Inc.",
      "title": "Content-Security-Policy protection for user content disabled by PLUGIN_NAME",
      "cve": "CVE-2024-23905",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins sets the `Content-Security-Policy` header to static files served by Jenkins (specifically `DirectoryBrowserSupport`), such as workspaces, `/userContent`, or archived artifacts, unless a Resource Root URL is specified.\n\nPLUGIN_NAME 0.7.1 and earlier globally disables the `Content-Security-Policy` header for static files served by Jenkins whenever the 'Invoke Red Hat Dependency Analytics (RHDA)' build step is executed.\nThis allows cross-site scripting (XSS) attacks by users with the ability to control files in workspaces, archived artifacts, etc.\n\nNOTE: Jenkins instances with link:/doc/book/security/user-content/#resource-root-url[Resource Root URL] configured are unaffected.\n\nPLUGIN_NAME 0.9.0 does not disable the `Content-Security-Policy` header for static files served by Jenkins anymore.",
      "plugins": [
        {
          "name": "redhat-dependency-analytics",
          "title": "Red Hat Dependency Analytics",
          "previous": "0.7.1",
          "fixed": "0.9.0"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins sets the <code>Content-Security-Policy</code> header to static files served by Jenkins (specifically <code>DirectoryBrowserSupport</code>), such as workspaces, <code>/userContent</code>, or archived artifacts, unless a Resource Root URL is specified.</p>\n</div>\n<div class=\"paragraph\">\n<p>Red Hat Dependency Analytics Plugin 0.7.1 and earlier globally disables the <code>Content-Security-Policy</code> header for static files served by Jenkins whenever the 'Invoke Red Hat Dependency Analytics (RHDA)' build step is executed.\nThis allows cross-site scripting (XSS) attacks by users with the ability to control files in workspaces, archived artifacts, etc.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nJenkins instances with <a href=\"/doc/book/security/user-content/#resource-root-url\">Resource Root URL</a> configured are unaffected.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Red Hat Dependency Analytics Plugin 0.9.0 does not disable the <code>Content-Security-Policy</code> header for static files served by Jenkins anymore.</p>\n</div>"
    },
    {
      "id": "SECURITY-3334",
      "reporter": null,
      "title": "Arbitrary file read vulnerability in PLUGIN_NAME",
      "cve": "CVE-2024-23904",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME uses the https://github.com/kohsuke/args4j[args4j library] to parse command arguments and options on the Jenkins controller when processing commands received via instant messaging platforms such as IRC or Jabber.\nThis command parser has a feature that replaces an `@` character followed by a file path in an argument with the file's contents (`expandAtFiles`).\nThis feature is enabled by default and PLUGIN_NAME 1.0.2 and earlier does not disable it.\n\nThis allows unauthenticated attackers to read the first line of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.\n\nSee link:#SECURITY-3314[SECURITY-3314] for further information about the potential impact of being able to read files on the Jenkins controller, as well as the link:#binary-files-note[limitations for reading binary files].\n\nNOTE: The severity of this issue assumes attackers have no access to Jenkins other than via instant messaging platforms.\nIf attackers can access Jenkins (even lacking Overall/Read permission), the severity is https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H[critical].\n\nAs of publication of this advisory, there is no fix.\nlink:/security/plugins/#unresolved[Learn why we announce this.]",
      "plugins": [
        {
          "name": "log-command",
          "title": "Log Command",
          "previous": "1.0.2",
          "fixed": null
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Log Command Plugin uses the <a href=\"https://github.com/kohsuke/args4j\">args4j library</a> to parse command arguments and options on the Jenkins controller when processing commands received via instant messaging platforms such as IRC or Jabber.\nThis command parser has a feature that replaces an <code>@</code> character followed by a file path in an argument with the file&#8217;s contents (<code>expandAtFiles</code>).\nThis feature is enabled by default and Log Command Plugin 1.0.2 and earlier does not disable it.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows unauthenticated attackers to read the first line of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.</p>\n</div>\n<div class=\"paragraph\">\n<p>See <a href=\"#SECURITY-3314\">SECURITY-3314</a> for further information about the potential impact of being able to read files on the Jenkins controller, as well as the <a href=\"#binary-files-note\">limitations for reading binary files</a>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThe severity of this issue assumes attackers have no access to Jenkins other than via instant messaging platforms.\nIf attackers can access Jenkins (even lacking Overall/Read permission), the severity is <a href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H\">critical</a>.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>As of publication of this advisory, there is no fix.\n<a href=\"/security/plugins/#unresolved\">Learn why we announce this.</a></p>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}