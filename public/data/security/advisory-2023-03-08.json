{
  "title": "Jenkins Security Advisory 2023-03-08",
  "date": "2023-03-08",
  "url": "/security/advisory/2023-03-08/",
  "kind": "core",
  "core": {
    "lts": {
      "previous": "2.375.3",
      "fixed": "2.375.4 or 2.387.1"
    },
    "weekly": {
      "previous": "2.393",
      "fixed": "2.394"
    }
  },
  "issues": [
    {
      "id": "SECURITY-3037",
      "reporter": "Ilay Goldman and Yakir Kadkoda from Aqua Security",
      "title": "XSS vulnerability in plugin manager",
      "cve": "CVE-2023-27898",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins 2.270 through 2.393 (both inclusive), LTS 2.277.1 through 2.375.3 (both inclusive) does not escape the Jenkins version a plugin depends on when rendering the error message stating its incompatibility with the current version of Jenkins in the plugin manager.\n\nThis results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide plugins to the configured update sites and have this message shown by Jenkins instances.\n\nIMPORTANT: Exploitation does _not_ require the manipulated plugin to be installed.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 escapes the Jenkins version a plugin depends on when rendering the error message stating its incompatibility with the current version of Jenkins.\n\n[NOTE]\n====\nDue to how Jenkins community update sites serve plugin metadata based on the reported Jenkins core version, it is unlikely that a reasonably up to date Jenkins instance shows the vulnerable error message in the plugin manager at all.\nAt least one of the following conditions needs to be met:\n\n* The Jenkins version used is older than about 13 months (before 2.333 or LTS 2.319.2 as of publication of this advisory), as all more recent releases of Jenkins receive update site metadata that only includes compatible versions of plugins.\n* Jenkins has been downgraded from a newer version, and no updated update site metadata has been requested since, so Jenkins will still display available plugins compatible with the previously newer version of Jenkins.\n* Custom update site URLs (i.e., not `+https://updates.jenkins.io/update-center.json+`) are configured, and those update sites behave differently.\n  We expect that most of these will host a fairly small set of vetted plugins (e.g., an organization's approved or internal plugins), preventing exploitation through their restrictive inclusion process.\n====\n\nNOTE: Jenkins community update sites no longer publish plugin releases with invalid Jenkins core dependencies since 2023-02-15.\nThis prevents exploitation through those update sites even on versions of Jenkins older than 13 months.\nAdditionally, the Jenkins security team has confirmed that no plugin release with a core dependency manipulated to exploit this vulnerability has ever been published by the Jenkins project.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins 2.270 through 2.393 (both inclusive), LTS 2.277.1 through 2.375.3 (both inclusive) does not escape the Jenkins version a plugin depends on when rendering the error message stating its incompatibility with the current version of Jenkins in the plugin manager.</p>\n</div>\n<div class=\"paragraph\">\n<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide plugins to the configured update sites and have this message shown by Jenkins instances.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nExploitation does <em>not</em> require the manipulated plugin to be installed.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 escapes the Jenkins version a plugin depends on when rendering the error message stating its incompatibility with the current version of Jenkins.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>Due to how Jenkins community update sites serve plugin metadata based on the reported Jenkins core version, it is unlikely that a reasonably up to date Jenkins instance shows the vulnerable error message in the plugin manager at all.\nAt least one of the following conditions needs to be met:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The Jenkins version used is older than about 13 months (before 2.333 or LTS 2.319.2 as of publication of this advisory), as all more recent releases of Jenkins receive update site metadata that only includes compatible versions of plugins.</p>\n</li>\n<li>\n<p>Jenkins has been downgraded from a newer version, and no updated update site metadata has been requested since, so Jenkins will still display available plugins compatible with the previously newer version of Jenkins.</p>\n</li>\n<li>\n<p>Custom update site URLs (i.e., not <code>https://updates.jenkins.io/update-center.json</code>) are configured, and those update sites behave differently.\nWe expect that most of these will host a fairly small set of vetted plugins (e.g., an organization&#8217;s approved or internal plugins), preventing exploitation through their restrictive inclusion process.</p>\n</li>\n</ul>\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nJenkins community update sites no longer publish plugin releases with invalid Jenkins core dependencies since 2023-02-15.\nThis prevents exploitation through those update sites even on versions of Jenkins older than 13 months.\nAdditionally, the Jenkins security team has confirmed that no plugin release with a core dependency manipulated to exploit this vulnerability has ever been published by the Jenkins project.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-2823",
      "reporter": "James Nord, CloudBees, Inc.",
      "title": "Temporary plugin file created with insecure permissions",
      "cve": "CVE-2023-27899",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "Jenkins creates a temporary file when a plugin is uploaded from an administrator's computer.\n\nJenkins 2.393 and earlier, LTS 2.375.3 and earlier creates this temporary file in the system temporary directory with the default permissions for newly created files.\n\nIf these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is installed in Jenkins, potentially resulting in arbitrary code execution.\n\nIMPORTANT: This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allows attackers to read the temporary file.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 creates the temporary file with more restrictive permissions.\n\nAs a workaround, you can set a different path as your default temporary directory using the Java system property `java.io.tmpdir`, if you're concerned about this issue but unable to immediately update Jenkins.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins creates a temporary file when a plugin is uploaded from an administrator&#8217;s computer.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.393 and earlier, LTS 2.375.3 and earlier creates this temporary file in the system temporary directory with the default permissions for newly created files.</p>\n</div>\n<div class=\"paragraph\">\n<p>If these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is installed in Jenkins, potentially resulting in arbitrary code execution.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nThis vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allows attackers to read the temporary file.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 creates the temporary file with more restrictive permissions.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround, you can set a different path as your default temporary directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>\n</div>"
    },
    {
      "id": "SECURITY-3030",
      "reporter": "Jakob Ackermann",
      "title": "DoS vulnerability in bundled Apache Commons FileUpload library",
      "cve": "CVE-2023-24998 (upstream issue), CVE-2023-27900 (MultipartFormDataParser), CVE-2023-27901 (StaplerRequest)",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H"
      },
      "description_adoc": "Jenkins 2.393 and earlier, LTS 2.375.3 and earlier is affected by the Apache Commons FileUpload library's vulnerability https://nvd.nist.gov/vuln/detail/CVE-2023-24998[CVE-2023-24998].\nThis library is used to process uploaded files via the Stapler web framework (usually through `StaplerRequest#getFile`) and `MultipartFormDataParser` in Jenkins.\n\nThis allows attackers to cause a denial of service (DoS) by sending crafted requests to HTTP endpoints processing file uploads.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 limits the number of request parts to be processed to 1000.\nSpecific endpoints receiving only simple form submissions have a lower limit.\n\nIMPORTANT: While the Apache Commons FileUpload dependency has been updated previously in the 2.392 weekly release, the Jenkins-specific changes in 2.394 are necessary for Jenkins to be protected.\n\nNOTE: Some Jenkins forms can be very complex, and these limits apply to all fields and not just fields representing uploaded files.\nAs a result, legitimate submissions of complex forms that include (possible) file uploads may be affected by these limits.\nIf that happens, these limits can be changed by setting the Java system properties link:/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_files[`hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_FILES`] and link:/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_files[`org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_FILES`] to a bigger value, or to `-1` to completely disable them.\n\n[NOTE]\n====\nThese releases of Jenkins also introduce additional Java system properties that can be set to restrict request sizes:\n\n* link:/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_file_size[`hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_FILE_SIZE`] and link:/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_file_size[`org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_FILE_SIZE`] allow limiting the size (in bytes) of individual fields that can be processed in one `multipart/form-data` request.\n* link:/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_size[`hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_SIZE`] and link:/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_size[`org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_SIZE`] allow limiting the total request size (in bytes) that can be processed in one `multipart/form-data` request.\n\nBy default, Jenkins does not set these size limits.\nSetting these system properties can offer additional protection, but comes at a greater risk of impacting legitimate use (e.g., when uploading huge file parameters).\n====",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins 2.393 and earlier, LTS 2.375.3 and earlier is affected by the Apache Commons FileUpload library&#8217;s vulnerability <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-24998\">CVE-2023-24998</a>.\nThis library is used to process uploaded files via the Stapler web framework (usually through <code>StaplerRequest#getFile</code>) and <code>MultipartFormDataParser</code> in Jenkins.</p>\n</div>\n<div class=\"paragraph\">\n<p>This allows attackers to cause a denial of service (DoS) by sending crafted requests to HTTP endpoints processing file uploads.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 limits the number of request parts to be processed to 1000.\nSpecific endpoints receiving only simple form submissions have a lower limit.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nWhile the Apache Commons FileUpload dependency has been updated previously in the 2.392 weekly release, the Jenkins-specific changes in 2.394 are necessary for Jenkins to be protected.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nSome Jenkins forms can be very complex, and these limits apply to all fields and not just fields representing uploaded files.\nAs a result, legitimate submissions of complex forms that include (possible) file uploads may be affected by these limits.\nIf that happens, these limits can be changed by setting the Java system properties <a href=\"/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_files\"><code>hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_FILES</code></a> and <a href=\"/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_files\"><code>org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_FILES</code></a> to a bigger value, or to <code>-1</code> to completely disable them.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>These releases of Jenkins also introduce additional Java system properties that can be set to restrict request sizes:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_file_size\"><code>hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_FILE_SIZE</code></a> and <a href=\"/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_file_size\"><code>org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_FILE_SIZE</code></a> allow limiting the size (in bytes) of individual fields that can be processed in one <code>multipart/form-data</code> request.</p>\n</li>\n<li>\n<p><a href=\"/doc/book/managing/system-properties/#hudson-util-multipartformdataparser-fileupload_max_size\"><code>hudson.util.MultipartFormDataParser.FILEUPLOAD_MAX_SIZE</code></a> and <a href=\"/doc/book/managing/system-properties/#org-kohsuke-stapler-requestimpl-fileupload_max_size\"><code>org.kohsuke.stapler.RequestImpl.FILEUPLOAD_MAX_SIZE</code></a> allow limiting the total request size (in bytes) that can be processed in one <code>multipart/form-data</code> request.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>By default, Jenkins does not set these size limits.\nSetting these system properties can offer additional protection, but comes at a greater risk of impacting legitimate use (e.g., when uploading huge file parameters).</p>\n</div>\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-1807",
      "reporter": "Markus Winter, SAP SE",
      "title": "Workspace temporary directories accessible through directory browser",
      "cve": "CVE-2023-27902",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "Jenkins uses temporary directories adjacent to workspace directories, usually with the `@tmp` name suffix, to store temporary files related to the build.\nIn pipelines, these temporary directories are adjacent to the current working directory when operating in a subdirectory of the automatically allocated workspace.\nJenkins-controlled processes, like SCMs, may store credentials in these directories.\n\nJenkins 2.393 and earlier, LTS 2.375.3 and earlier shows these temporary directories when viewing job workspaces, which allows attackers with Item/Workspace permission to access their contents.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 does not list these temporary directories in job workspaces.\n\nAs a workaround, do not grant Item/Workspace permission to users who lack Item/Configure permission, if you're concerned about this issue but unable to immediately update Jenkins.\n\nNOTE: The link:/doc/book/managing/system-properties/#hudson-model-directorybrowsersupport-allowtmpescape[Java system property `hudson.model.DirectoryBrowserSupport.allowTmpEscape`] can be set to `true` to restore the previous behavior.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins uses temporary directories adjacent to workspace directories, usually with the <code>@tmp</code> name suffix, to store temporary files related to the build.\nIn pipelines, these temporary directories are adjacent to the current working directory when operating in a subdirectory of the automatically allocated workspace.\nJenkins-controlled processes, like SCMs, may store credentials in these directories.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.393 and earlier, LTS 2.375.3 and earlier shows these temporary directories when viewing job workspaces, which allows attackers with Item/Workspace permission to access their contents.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 does not list these temporary directories in job workspaces.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround, do not grant Item/Workspace permission to users who lack Item/Configure permission, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThe <a href=\"/doc/book/managing/system-properties/#hudson-model-directorybrowsersupport-allowtmpescape\">Java system property <code>hudson.model.DirectoryBrowserSupport.allowTmpEscape</code></a> can be set to <code>true</code> to restore the previous behavior.\n</td>\n</tr>\n</table>\n</div>"
    },
    {
      "id": "SECURITY-3058",
      "reporter": "Kevin Guerroudj, CloudBees, Inc.",
      "title": "Temporary file parameter created with insecure permissions",
      "cve": "CVE-2023-27903",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "When triggering a build from the Jenkins CLI, Jenkins creates a temporary file on the controller if a file parameter is provided through the CLI's standard input.\n\nJenkins 2.393 and earlier, LTS 2.375.3 and earlier creates this temporary file in the default temporary directory with the default permissions for newly created files.\n\nIf these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is used in the build.\n\nIMPORTANT: This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allows attackers to read the temporary file.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 creates the temporary file with more restrictive permissions.\n\nAs a workaround, you can set a different path as your default temporary directory using the Java system property `java.io.tmpdir`, if you're concerned about this issue but unable to immediately update Jenkins.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>When triggering a build from the Jenkins CLI, Jenkins creates a temporary file on the controller if a file parameter is provided through the CLI&#8217;s standard input.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.393 and earlier, LTS 2.375.3 and earlier creates this temporary file in the default temporary directory with the default permissions for newly created files.</p>\n</div>\n<div class=\"paragraph\">\n<p>If these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is used in the build.</p>\n</div>\n<div class=\"admonitionblock important\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\nThis vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).\nAdditionally, the default permissions for newly created files generally only allows attackers to read the temporary file.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 creates the temporary file with more restrictive permissions.</p>\n</div>\n<div class=\"paragraph\">\n<p>As a workaround, you can set a different path as your default temporary directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>\n</div>"
    },
    {
      "id": "SECURITY-2120",
      "reporter": null,
      "title": "Information disclosure through error stack traces related to agents",
      "cve": "CVE-2023-27904",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "Jenkins 2.393 and earlier, LTS 2.375.3 and earlier prints an error stack trace on agent-related pages when agent connections are broken.\nThis stack trace may contain information about Jenkins configuration that is otherwise inaccessible to attackers.\n\nJenkins 2.394, LTS 2.375.4, and LTS 2.387.1 does not display error stack traces when agent connections are broken.",
      "plugins": [],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Jenkins 2.393 and earlier, LTS 2.375.3 and earlier prints an error stack trace on agent-related pages when agent connections are broken.\nThis stack trace may contain information about Jenkins configuration that is otherwise inaccessible to attackers.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins 2.394, LTS 2.375.4, and LTS 2.387.1 does not display error stack traces when agent connections are broken.</p>\n</div>"
    },
    {
      "id": "SECURITY-3063",
      "reporter": "Ilay Goldman and Yakir Kadkoda from Aqua Security",
      "title": "XSS vulnerability in update-center2",
      "cve": "CVE-2023-27905",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
      },
      "description_adoc": "https://github.com/jenkins-infra/update-center2/[update-center2] is the tool used to generate the Jenkins update sites hosted on `updates.jenkins.io`.\n\nNOTE: While it is designed for use by the Jenkins project for this purpose, others may be using it to operate their own self-hosted update sites.\n\nupdate-center2 3.13 and 3.14 renders the required Jenkins core version on plugin download index pages (pages like https://updates.jenkins.io/download/plugins/matrix-auth/[this]).\nThis version is taken from plugin metadata without being sanitized.\n\nThis results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide a plugin for hosting.\n\nThe following preconditions must both be satisfied for this to be exploitable in a self-hosted update-center2:\n\n* The generation of download pages needs to be enabled (i.e., the `--download-links-directory` argument needs to be set).\n* A custom download page template must be used (`--index-template-url` argument), and the template used must not prevent JavaScript execution through `Content-Security-Policy`.\n  The default template prevents exploitation by declaring a restrictive `Content-Security-Policy`.\n\nupdate-center2 3.15 filters out plugin releases with invalid Jenkins core dependencies.\n\nAdministrators hosting their own update sites using update-center2 or a fork thereof are advised to update it, or integrate the commit https://github.com/jenkins-infra/update-center2/commit/091ef99908f4fb111665669865b4d92821fb0e5b[`091ef999`].\n\nNOTE: This change has been deployed to Jenkins community update sites on 2023-02-15.\nThe Jenkins project has distributed a single plugin release, that exploited this vulnerability in a harmless way to demonstrate the issue, for two hours on 2023-01-16.\nNo other plugin releases that exploit this vulnerability have been published.",
      "plugins": [],
      "components": [
        {
          "name": "update-center2",
          "title": "update-center2",
          "previous": "3.14",
          "fixed": "3.15"
        }
      ],
      "description_html": "<div class=\"paragraph\">\n<p><a href=\"https://github.com/jenkins-infra/update-center2/\">update-center2</a> is the tool used to generate the Jenkins update sites hosted on <code>updates.jenkins.io</code>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nWhile it is designed for use by the Jenkins project for this purpose, others may be using it to operate their own self-hosted update sites.\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>update-center2 3.13 and 3.14 renders the required Jenkins core version on plugin download index pages (pages like <a href=\"https://updates.jenkins.io/download/plugins/matrix-auth/\">this</a>).\nThis version is taken from plugin metadata without being sanitized.</p>\n</div>\n<div class=\"paragraph\">\n<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide a plugin for hosting.</p>\n</div>\n<div class=\"paragraph\">\n<p>The following preconditions must both be satisfied for this to be exploitable in a self-hosted update-center2:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The generation of download pages needs to be enabled (i.e., the <code>--download-links-directory</code> argument needs to be set).</p>\n</li>\n<li>\n<p>A custom download page template must be used (<code>--index-template-url</code> argument), and the template used must not prevent JavaScript execution through <code>Content-Security-Policy</code>.\nThe default template prevents exploitation by declaring a restrictive <code>Content-Security-Policy</code>.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>update-center2 3.15 filters out plugin releases with invalid Jenkins core dependencies.</p>\n</div>\n<div class=\"paragraph\">\n<p>Administrators hosting their own update sites using update-center2 or a fork thereof are advised to update it, or integrate the commit <a href=\"https://github.com/jenkins-infra/update-center2/commit/091ef99908f4fb111665669865b4d92821fb0e5b\"><code>091ef999</code></a>.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\nThis change has been deployed to Jenkins community update sites on 2023-02-15.\nThe Jenkins project has distributed a single plugin release, that exploited this vulnerability in a harmless way to demonstrate the issue, for two hours on 2023-01-16.\nNo other plugin releases that exploit this vulnerability have been published.\n</td>\n</tr>\n</table>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}