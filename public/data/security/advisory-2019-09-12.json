{
  "title": "Jenkins Security Advisory 2019-09-12",
  "date": "2019-09-12",
  "url": "/security/advisory/2019-09-12/",
  "kind": "plugins",
  "core": null,
  "issues": [
    {
      "id": "SECURITY-1534",
      "reporter": "Francesco Soncina - ABN AMRO Red Team - https://iwantmore.pizza",
      "title": "System command execution vulnerability in PLUGIN_NAME",
      "cve": "CVE-2019-10392",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
      },
      "description_adoc": "PLUGIN_NAME accepts user-specified values as argument to an invocation of `git ls-remote` to validate the existence of a Git repository at the specified URL.\nThis was implemented in a way that allowed attackers with Job/Configure permission to execute an arbitrary system command on the Jenkins controller as the OS user that the Jenkins process is running as.\n\nPLUGIN_NAME now rejects repository URLs that do not appear to be valid URLs.\nAdditionally, for versions of Git that support it, the repository URL argument is separated from option arguments using the `--` separator to prevent interpretation as an option.\n\nAs of publication of this advisory, no update for users of prerelease versions of 3.x such as 3.0.0-rc is available.\nUsers of PLUGIN_NAME 3.0.0-rc are advised to downgrade to 2.8.5 (and downgrade plugin:git[Git Plugin] from 4.0.0-rc to the latest 3.x release to resolve dependency problems).",
      "plugins": [
        {
          "name": "git-client",
          "title": "Git client",
          "previous": "2.8.4",
          "fixed": "2.8.5"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Git client Plugin accepts user-specified values as argument to an invocation of <code>git ls-remote</code> to validate the existence of a Git repository at the specified URL.\nThis was implemented in a way that allowed attackers with Job/Configure permission to execute an arbitrary system command on the Jenkins controller as the OS user that the Jenkins process is running as.</p>\n</div>\n<div class=\"paragraph\">\n<p>Git client Plugin now rejects repository URLs that do not appear to be valid URLs.\nAdditionally, for versions of Git that support it, the repository URL argument is separated from option arguments using the <code>--</code> separator to prevent interpretation as an option.</p>\n</div>\n<div class=\"paragraph\">\n<p>As of publication of this advisory, no update for users of prerelease versions of 3.x such as 3.0.0-rc is available.\nUsers of Git client Plugin 3.0.0-rc are advised to downgrade to 2.8.5 (and downgrade plugin:git[Git Plugin] from 4.0.0-rc to the latest 3.x release to resolve dependency problems).</p>\n</div>"
    },
    {
      "id": "SECURITY-1538",
      "reporter": "Nils Emmerich of ERNW Research GmbH",
      "title": "Sandbox bypass vulnerability in PLUGIN_NAME",
      "cve": "CVE-2019-10393, CVE-2019-10394, CVE-2019-10399, CVE-2019-10400",
      "cvss": {
        "severity": "High",
        "vector": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N"
      },
      "description_adoc": "Sandbox protection in PLUGIN_NAME could be circumvented through any of the following:\n\n* Crafted method names in method call expressions (CVE-2019-10393)\n* Crafted property names in property expressions on the left-hand side of assignment expressions (CVE-2019-10394)\n* Crafted property names in property expressions in increment and decrement expressions (CVE-2019-10399)\n* Crafted subexpressions in increment and decrement expressions not involving actual assignment (CVE-2019-10400)\n\nThis allowed attackers able to specify and run sandboxed scripts to execute arbitrary code in the context of the Jenkins controller JVM.\n\nThese expressions are now subject to sandbox protection.",
      "plugins": [
        {
          "name": "script-security",
          "title": "Script Security",
          "previous": 1.62,
          "fixed": 1.63
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Sandbox protection in Script Security Plugin could be circumvented through any of the following:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Crafted method names in method call expressions (CVE-2019-10393)</p>\n</li>\n<li>\n<p>Crafted property names in property expressions on the left-hand side of assignment expressions (CVE-2019-10394)</p>\n</li>\n<li>\n<p>Crafted property names in property expressions in increment and decrement expressions (CVE-2019-10399)</p>\n</li>\n<li>\n<p>Crafted subexpressions in increment and decrement expressions not involving actual assignment (CVE-2019-10400)</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>This allowed attackers able to specify and run sandboxed scripts to execute arbitrary code in the context of the Jenkins controller JVM.</p>\n</div>\n<div class=\"paragraph\">\n<p>These expressions are now subject to sandbox protection.</p>\n</div>"
    },
    {
      "id": "SECURITY-1476",
      "reporter": "Viktor Gazdag NCC Group",
      "title": "Stored XSS vulnerability in PLUGIN_NAME",
      "cve": "CVE-2019-10395",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME did not escape values of environment variables shown on its views.\nThis resulted in a cross-site scripting vulnerability exploitable by attackers able to control the values of build environment variables, typically users with Job/Configure or Job/Build permission.\n\nJenkins applies the missing escaping by default since 2.146 and LTS 2.138.2, so newer Jenkins releases are not affected by this vulnerability.\n\nPLUGIN_NAME now escapes all variables displayed in its views.",
      "plugins": [
        {
          "name": "build-environment",
          "title": "Build Environment",
          "previous": 1.6,
          "fixed": 1.7
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Build Environment Plugin did not escape values of environment variables shown on its views.\nThis resulted in a cross-site scripting vulnerability exploitable by attackers able to control the values of build environment variables, typically users with Job/Configure or Job/Build permission.</p>\n</div>\n<div class=\"paragraph\">\n<p>Jenkins applies the missing escaping by default since 2.146 and LTS 2.138.2, so newer Jenkins releases are not affected by this vulnerability.</p>\n</div>\n<div class=\"paragraph\">\n<p>Build Environment Plugin now escapes all variables displayed in its views.</p>\n</div>"
    },
    {
      "id": "SECURITY-1489",
      "reporter": "Viktor Gazdag NCC Group",
      "title": "Stored XSS vulnerability in PLUGIN_NAME",
      "cve": "CVE-2019-10396",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N"
      },
      "description_adoc": "PLUGIN_NAME did not escape the build description on the Latest Builds View.\nThis resulted in a cross-site scripting vulnerability exploitable by attackers able to control the description of builds shown on that view.\n\nPLUGIN_NAME now applies the configured markup formatter to the build description, rendering it as it appears elsewhere in Jenkins.",
      "plugins": [
        {
          "name": "dashboard-view",
          "title": "Dashboard View",
          "previous": 2.11,
          "fixed": 2.12
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Dashboard View Plugin did not escape the build description on the Latest Builds View.\nThis resulted in a cross-site scripting vulnerability exploitable by attackers able to control the description of builds shown on that view.</p>\n</div>\n<div class=\"paragraph\">\n<p>Dashboard View Plugin now applies the configured markup formatter to the build description, rendering it as it appears elsewhere in Jenkins.</p>\n</div>"
    },
    {
      "id": "SECURITY-1509",
      "reporter": "James Holderness, IB Boost",
      "title": "PLUGIN_NAME showed plain text password in job configuration form fields",
      "cve": "CVE-2019-10397",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stores service passwords in job configurations.\n\nWhile the password is stored encrypted on disk, it was transmitted in plain text as part of the configuration form.\nThis could result in exposure of the password through browser extensions, cross-site scripting vulnerabilities, and similar situations.\n\nPLUGIN_NAME no longer transmits the password form field in plain text.",
      "plugins": [
        {
          "name": "aqua-serverless",
          "title": "Aqua Security Serverless Scanner",
          "previous": "1.0.4",
          "fixed": "1.0.5"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Aqua Security Serverless Scanner Plugin stores service passwords in job configurations.</p>\n</div>\n<div class=\"paragraph\">\n<p>While the password is stored encrypted on disk, it was transmitted in plain text as part of the configuration form.\nThis could result in exposure of the password through browser extensions, cross-site scripting vulnerabilities, and similar situations.</p>\n</div>\n<div class=\"paragraph\">\n<p>Aqua Security Serverless Scanner Plugin no longer transmits the password form field in plain text.</p>\n</div>"
    },
    {
      "id": "SECURITY-1545",
      "reporter": "James Holderness, IB Boost",
      "title": "PLUGIN_NAME stored credentials in plain text",
      "cve": "CVE-2019-10398",
      "cvss": {
        "severity": "Low",
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "PLUGIN_NAME stored the Beaker password unencrypted on the Jenkins controller.\nThis password could be viewed by users with access to the Jenkins controller file system.\n\nPLUGIN_NAME now stores these credentials encrypted.",
      "plugins": [
        {
          "name": "beaker-builder",
          "title": "Beaker builder",
          "previous": 1.9,
          "fixed": "1.10"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Beaker builder Plugin stored the Beaker password unencrypted on the Jenkins controller.\nThis password could be viewed by users with access to the Jenkins controller file system.</p>\n</div>\n<div class=\"paragraph\">\n<p>Beaker builder Plugin now stores these credentials encrypted.</p>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}