{
  "title": "Jenkins Security Advisory 2019-05-21",
  "date": "2019-05-21",
  "url": "/security/advisory/2019-05-21/",
  "kind": "plugins",
  "core": null,
  "issues": [
    {
      "id": "SECURITY-1316",
      "reporter": "Daniel Beck, CloudBees, Inc.",
      "title": "Missing permission check allowed obtaining limited information about system configuration in PLUGIN_NAME\n",
      "cve": "CVE-2019-10319",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N"
      },
      "description_adoc": "A missing permission check in PLUGIN_NAME allowed users with Overall/Read permission to invoke a form validation method to obtain limited information about the file `/etc/shadow` on systems with that file present, as well as the system user the Jenkins process is running as.\n\nDepending on configuration, one of the following messages could be obtained by an attacker:\n\n* _\"Jenkins needs to be able to read /etc/shadow\"_\n* _\"(1) needs to belong to group (2) to read /etc/shadow\"_\n* _\"Either Jenkins needs to run as (3) or (1) needs to belong to group (2) and 'chmod g+r /etc/shadow' needs to be done to enable Jenkins to read /etc/shadow\"_\n* _\"Success\"_\n\nThe numeric placeholders in the messages above would be populated with the following values:\n\n. The system user that the Jenkins controller process is running as (usually `jenkins`)\n. The group owning `/etc/shadow`\n. The user owning `/etc/shadow`\n\nThis form validation method now requires Overall/Administer permission.",
      "plugins": [
        {
          "name": "pam-auth",
          "title": "PAM Authentication",
          "previous": 1.5,
          "fixed": "1.5.1"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>A missing permission check in PAM Authentication Plugin allowed users with Overall/Read permission to invoke a form validation method to obtain limited information about the file <code>/etc/shadow</code> on systems with that file present, as well as the system user the Jenkins process is running as.</p>\n</div>\n<div class=\"paragraph\">\n<p>Depending on configuration, one of the following messages could be obtained by an attacker:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><em>\"Jenkins needs to be able to read /etc/shadow\"</em></p>\n</li>\n<li>\n<p><em>\"(1) needs to belong to group (2) to read /etc/shadow\"</em></p>\n</li>\n<li>\n<p><em>\"Either Jenkins needs to run as (3) or (1) needs to belong to group (2) and 'chmod g+r /etc/shadow' needs to be done to enable Jenkins to read /etc/shadow\"</em></p>\n</li>\n<li>\n<p><em>\"Success\"</em></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>The numeric placeholders in the messages above would be populated with the following values:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>The system user that the Jenkins controller process is running as (usually <code>jenkins</code>)</p>\n</li>\n<li>\n<p>The group owning <code>/etc/shadow</code></p>\n</li>\n<li>\n<p>The user owning <code>/etc/shadow</code></p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>This form validation method now requires Overall/Administer permission.</p>\n</div>"
    },
    {
      "id": "SECURITY-1322",
      "reporter": "Yakov Shafranovich and Pankaj Upadhyay; T. Rowe Price Associates, Inc.",
      "title": "Certificate file read vulnerability in PLUGIN_NAME\n",
      "cve": "CVE-2019-10320",
      "cvss": {
        "severity": "Medium",
        "vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
      },
      "description_adoc": "Credentials Plugin allowed the creation of Certificate credentials from a PKCS#12 file on the Jenkins controller.\nUsers with permission to create or update credentials could use the associated form validation to confirm the existence of files with an attacker-specified path.\n\nAdditionally, they could create credentials from any valid PKCS#12 file on the Jenkins controller.\nWith the ability to configure jobs to access these credentials, they could obtain the certificate content.\n\nCredentials Plugin no longer supports Certificate credentials from PKCS#12 files on the Jenkins controller file system.\nExisting Certificate credentials of this kind are automatically migrated to _directly entered_ Certificate credentials during Jenkins startup.\n\n[NOTE]\n====\nDue to technical limitations, these migrated credentials are not immediately persisted.\nIn rare situations a non-administrator user might access a credential migrated this way and encounter a permission error.\nThe solution is to save affected credentials manually, either individually through the UI or with the following script for the Script Console:\n\n----\ncom.cloudbees.plugins.credentials.CredentialsProvider.saveAll()\n----\n\nThis operation may impact performance.\n\nIn almost all cases the automatic migration will work and these additional steps will be unnecessary.\n====",
      "plugins": [
        {
          "name": "credentials",
          "title": "Credentials",
          "previous": "2.1.18",
          "fixed": "2.1.19"
        }
      ],
      "components": [],
      "description_html": "<div class=\"paragraph\">\n<p>Credentials Plugin allowed the creation of Certificate credentials from a PKCS#12 file on the Jenkins controller.\nUsers with permission to create or update credentials could use the associated form validation to confirm the existence of files with an attacker-specified path.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, they could create credentials from any valid PKCS#12 file on the Jenkins controller.\nWith the ability to configure jobs to access these credentials, they could obtain the certificate content.</p>\n</div>\n<div class=\"paragraph\">\n<p>Credentials Plugin no longer supports Certificate credentials from PKCS#12 files on the Jenkins controller file system.\nExisting Certificate credentials of this kind are automatically migrated to <em>directly entered</em> Certificate credentials during Jenkins startup.</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<i class=\"fa icon-note\" title=\"Note\"></i>\n</td>\n<td class=\"content\">\n<div class=\"paragraph\">\n<p>Due to technical limitations, these migrated credentials are not immediately persisted.\nIn rare situations a non-administrator user might access a credential migrated this way and encounter a permission error.\nThe solution is to save affected credentials manually, either individually through the UI or with the following script for the Script Console:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre>com.cloudbees.plugins.credentials.CredentialsProvider.saveAll()</pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>This operation may impact performance.</p>\n</div>\n<div class=\"paragraph\">\n<p>In almost all cases the automatic migration will work and these additional steps will be unnecessary.</p>\n</div>\n</td>\n</tr>\n</table>\n</div>"
    }
  ],
  "components": [],
  "index_details_html": null,
  "content_html": null
}