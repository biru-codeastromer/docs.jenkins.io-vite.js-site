{
  "id": "2024-09-2024-09-04-update-center-brownouts",
  "url": "/blog/2024/09/04/2024-09-04-update-center-brownouts/",
  "title": "Brownout on Update Center (updates.jenkins.io):\n 6 and 9 September 2024",
  "date": "2024-09-04",
  "authors": [
    "dduportal"
  ],
  "tags": [
    "jenkins",
    "jenkins-infra",
    "update-center"
  ],
  "summary": "== Summary () The service https://updates.jenkins.io will switch its implementation to a new system during 1 hour twice: - Friday 6 September 2024 from 07:00am UTC until 08:00am UTC - Monday 9 September 2024 from 02:00pm UTC until 03:00pm UTC All Jenkins users are impacted but should not see any functional change. ⚠️ Please, check that your organization respects the…",
  "opengraph_image": "/images/post-images/2023/01/12/jenkins-newsletter/infrastructure.png",
  "content_html": "<div class=\"sect1\">\n<h2 id=\"summary-tldr\"><a class=\"anchor\" href=\"#summary-tldr\"></a>Summary (<a href=\"https://en.wikipedia.org/wiki/Wikipedia:Too_long;_didn%27t_read\">TL;DR</a>)</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The service <a href=\"https://updates.jenkins.io\" class=\"bare\">https://updates.jenkins.io</a> will switch its implementation to a new system during 1 hour twice:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Friday 6 September 2024 from 07:00am UTC until 08:00am UTC</p>\n</li>\n<li>\n<p>Monday 9 September 2024 from 02:00pm UTC until 03:00pm UTC</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>All Jenkins users are impacted but should not see any functional change.</p>\n</div>\n<div class=\"paragraph\">\n<p>⚠️ Please, check that your organization respects the advertised DNS TTL or you might be stuck in the brownout longer that expected.</p>\n</div>\n<div class=\"paragraph\">\n<p>Under the hood, any HTTP request made to this service will be redirected to a mirror close to user locations during these brownouts.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"what-is-the-update-center\"><a class=\"anchor\" href=\"#what-is-the-update-center\"></a>What is the \"Update Center\"?</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Jenkins <a href=\"https://updates.jenkins.io\">Update Center</a> is a web server at the core of the Jenkins public infrastructure which distributes the plugins, tool installers, and versions index to all Jenkins servers all across the world.</p>\n</div>\n<div class=\"paragraph\">\n<p>From the Wizard installation to regular plugin updates, if you run Jenkins then you use this service under the hood.</p>\n</div>\n<div class=\"paragraph\">\n<p>Today, it serves around 50 Tb of data (outbound bandwidth) each month from a single Virtual Machine on AWS, which costs around $6,000 per month.</p>\n</div>\n<div class=\"paragraph\">\n<p>In order to sustain this service and improve it, the Jenkins infrastructure team has worked relentlessly during the past years to have a new sustainable implementation for this service.</p>\n</div>\n<div class=\"paragraph\">\n<p>The new Update Center implementation features a highly available system, which redirects user requests to a download mirror close to their location.\nThere is lots of details and additional information that you can read further about in the following <a href=\"https://github.com/jenkins-infra/helpdesk/issues/2649\">GitHub issue</a>.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"why-this-brownout\"><a class=\"anchor\" href=\"#why-this-brownout\"></a>Why this \"<a href=\"https://en.wikipedia.org/wiki/Brownout_(electricity)\">Brownout</a>\"?</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>We have reached the point where our functional/performance tests are meeting our expectation:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>All of our Jenkins controllers are using the new Update Center implementation.</p>\n</li>\n<li>\n<p>We are using the new updates center (with DNS override) in our own networks in different geo-locations.</p>\n</li>\n<li>\n<p>All of our Jenkins Docker image are using the new system.</p>\n</li>\n<li>\n<p>Our initial performance tests</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>But as the adage says: \"No plan survives first contact\".</p>\n</div>\n<div class=\"paragraph\">\n<p>That's why we are planning these brownouts of one hour each to:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Validate our system beyond the tests we already ran to increase trust.</p>\n</li>\n<li>\n<p>Run a real life (production!) workload against the new system while limiting any unforeseen impact due to the short time window.</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"how\"><a class=\"anchor\" href=\"#how\"></a>How</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Both current and new Update Centers are updated at the same time and serve the same index.</p>\n</div>\n<div class=\"paragraph\">\n<p>Starting 4 weeks ago, the Jenkins infrastructure has been using the new Update Center (<a href=\"https://azure.updates.jenkins.io\" class=\"bare\">https://azure.updates.jenkins.io</a>) with a client-side DNS override (<code>updates.jenkins.io</code> hostname points to this new service).</p>\n</div>\n<div class=\"paragraph\">\n<p>During the brownouts, we'll simply switch the DNS entry <code>updates.jenkins.io</code> to this new service and watch for the logs and error rate.\nAt the end of each brownout, we'll switch DNS back to the normal service and then analyze metrics and logs to see how the system behaved.</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>If no major problem is detected then we'll plan a 24 hours brownout soon.</p>\n</li>\n<li>\n<p>Otherwise we'll analyze the discovered problem and plan solutions.</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>The first brownout covers Asia + Europe \"activity\" timezones while the second covers US + Europe so we can have 2 distinct set of usages.</p>\n</div>\n<div class=\"paragraph\">\n<p>Please refer to the <a href=\"https://github.com/jenkins-infra/helpdesk/issues/2649\">helpdesk ticket</a> for more information.</p>\n</div>\n</div>\n</div>"
}