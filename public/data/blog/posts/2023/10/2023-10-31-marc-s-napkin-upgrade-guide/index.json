{
  "id": "2023-10-2023-10-31-marc-s-napkin-upgrade-guide",
  "url": "/blog/2023/10/31/2023-10-31-marc-s-napkin-upgrade-guide/",
  "title": "Back of the Napkin Guide to Updating Jenkins, for the uninitiated",
  "date": "2023-10-31",
  "authors": [
    "mwp565733"
  ],
  "tags": [
    "jenkins",
    "upgrade",
    "plugins"
  ],
  "summary": ". Prologue Here&#8217;s a brief account of my journey to update my Jenkins Servers. Think of this as a \"back of the napkin\" guide that I used to research and upgrade my Jenkins Servers, which had been left unattended for far too long. I know many of you are seasoned experts - I wasn&#8217;t. I&#8217;ve included references that I found…",
  "opengraph_image": "/images/post-images/2023/10/31/upgrade-guide-this-is-the-way.png",
  "content_html": "<div class=\"paragraph\">\n<p><span class=\"image\"><img src=\"/images/post-images/2023/10/31/upgrade-jenkins-from-manage-jenkins.png\" alt=\"Upgrade Jenkins\"></span>.</p>\n</div>\n<div class=\"sect1\">\n<h2 id=\"prologue\"><a class=\"anchor\" href=\"#prologue\"></a>Prologue</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Here&#8217;s a brief account of my journey to update my Jenkins Servers.\nThink of this as a \"back of the napkin\" guide that I used to research and upgrade my Jenkins Servers, which had been left unattended for far too long.\nI know many of you are seasoned experts - I wasn&#8217;t.\nI&#8217;ve included references that I found useful in my research, but keep in mind, your setup may be different from mine.\nI hope this helps others in their journey.</p>\n</div>\n<div class=\"paragraph\">\n<p>Yours in Jenkins,\nauthor:mwp565733[Marc]</p>\n</div>\n<div class=\"quoteblock\">\n<blockquote>\n<div class=\"paragraph\">\n<p>“This is the way”</p>\n</div>\n</blockquote>\n</div>\n<div class=\"sect2\">\n<h3 id=\"pre-work\"><a class=\"anchor\" href=\"#pre-work\"></a>Pre-work:</h3>\n<div class=\"paragraph\">\n<p>Grab your plugin list and dive into the <code>Change log</code>.\nYou&#8217;re going to want to pore over EVERY change log from your current version to your target version, and every single iteration in between.\nKeep an eye out for any mentions of your plugins and Java versions (both client and primary) in the Change Log. You&#8217;re building a validation checklist here (e.g., does SSH still work? Is the plugin functioning properly?).</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>ADDED ROI</strong>: While you&#8217;re scrutinizing your plugins, take a moment to consider which ones are gathering dust. Are any of them deprecated? Do you still need them? Try deactivating them (before you outright remove them) and see if anyone kicks up a fuss.</p>\n</div>\n<div class=\"paragraph\">\n<p><code>Backup Security roles and Users</code>: If you&#8217;re using LDAP/AD, make offline copies of your Security groups and access, User Lists and Security groups (<em>&lt;jenkins_url&gt;/manage/role-strategy/</em> &amp;&amp; <em>&lt;jenkins_url&gt;/manage/role-strategy/assign-roles</em>).\nDon&#8217;t forget to backup configurations to access the Active Directory too (<em>&lt;jenkins_url&gt;/configureSecurity/</em>).</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"let-the-work-begin\"><a class=\"anchor\" href=\"#let-the-work-begin\"></a>Let the work begin:</h3>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Get cozy with your backups for those inevitable rollbacks.\nI had quite the love affair with plugins&#8230;&#8203; making a tar/zip archive of /JENKINS_HOME/plugins was a lifesaver.\nSome plugins, like <a href=\"https://plugins.jenkins.io/active-directory/\">Active Directory</a>,\nreally threw me for a loop during updates.</p>\n</li>\n<li>\n<p><code>SNAPSHOTS</code>: Take them at the beginning, and after each benchmark, if you can afford the luxury.</p>\n</li>\n<li>\n<p><code>Update Plugins</code>: Aim for the highest compatible level. I found that reaching for the \"highest level\" sometimes led to unnecessary headaches. Keep it simple, kid. <strong>SNAPSHOT:</strong> Archive the &lt;JENKINS_HOME&gt;/plugins/ folder.</p>\n</li>\n<li>\n<p><code>Update the Core application</code>: Stick with the method you used for the initial install.\nI&#8217;m running on RHEL and used yum&#8230;&#8203;\nI tried getting fancy with downloading the war file, but it kept throwing tantrums&#8230;&#8203;\nStick with what you know.\nKeep in mind, versions pre-2.400 used a different security key than post-2.400 (<a href=\"/blog/2023/03/27/repository-signing-keys-changing/\">Jenkins 2.397 and 2.387.2:\nNew Linux Repository Signing Keys</a>).</p>\n</li>\n<li>\n<p><code>Update plugins <em>AGAIN</em></code>: Aim for the highest \"compatible\" level (hopefully, it&#8217;s the highest level now).</p>\n</li>\n<li>\n<p><code>Plugin configuration</code>: My CVS plugin was a bit needy, requiring files not in the hpi install file. Follow the appropriate plugin documentation to satisfy these dependencies.\nEstablish connections to external databases and services (AD/CVS/etc.).\n<strong>Special anecdote</strong>: I had a bit of a tiff with the \"Require TLS\" checkbox for the LDAPS connect&#8230;&#8203; a conflict needed to be resolved.\nSpecifically, I had to tweak the systemctl for Jenkins&#8230;&#8203; ensure <code>-Dhudson.plugins.active_directory.ActiveDirectorySecurityRealm.forceLdaps=true</code> was removed before enabling that checkbox, else you&#8217;ll be dealing with authentication errors with LDAPS <sub><a href=\"https://plugins.jenkins.io/active-directory/#plugin-content-encryption-support\">Reference</a></sub></p>\n</li>\n<li>\n<p><code>Validation</code>: Time to check that list you made earlier&#8230;&#8203; can you SSH out to client servers?\nCan you connect to your external services/databases?</p>\n</li>\n</ol>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"cleanup\"><a class=\"anchor\" href=\"#cleanup\"></a>Cleanup:</h3>\n<div class=\"paragraph\">\n<p>Depending on the scale of your upgrade, you might want to <code>re-examine your plugins</code>.\nSome plugins might have been sent out to pasture as their functionality gets folded into the Core.\nConsider these plugins for deactivation, and maybe even removal down the line.\nThis little cleanup could help plug some security holes (and put a smile on your CISO&#8217;s face).\nRemember to do a little jig after each disable/remove and application recycle.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"epilogue\"><a class=\"anchor\" href=\"#epilogue\"></a>Epilogue</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>This is a story without an end&#8230;&#8203;\nIt&#8217;s not a one-and-done deal.\nAfter I finished the upgrade cycle, I made weekly pilgrimages to each server to update plugins, disable ones that seemed to be gathering dust, remove the ones that <em>WERE</em> just collecting dust, and address any warnings that popped up in the Jenkins UI.\nThe more you do it, the easier it gets.\nI had a few practice runs on my sandbox server before I dared to touch the production servers.\nAnd I kept taking snapshots as I went along, like a tourist in my own code.</p>\n</div>\n<div class=\"paragraph\">\n<p>This is my tale&#8230;&#8203; now it&#8217;s time for you to write yours.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"references\"><a class=\"anchor\" href=\"#references\"></a>References:</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Core app updated</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"/doc/book/installing/\">Installation guide for Jenkins</a></p>\n</li>\n<li>\n<p><a href=\"/doc/book/installing/linux/#red-hat-centos\">Installation guide for Jenkins RHEL</a></p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Change log</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"/doc/upgrade-guide/\">Jenkins Change Log for upgrades</a></p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Plug-in references</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://plugins.jenkins.io/\">Jenkins Plugin Library</a></p>\n</li>\n<li>\n<p><a href=\"https://plugins.jenkins.io/active-directory/\">Jenkins Active Directory Plugin</a></p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://plugins.jenkins.io/active-directory/#plugin-content-encryption-support\">Active Directory forceLdaps guidance</a></p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p><a href=\"https://plugins.jenkins.io/dimensionsscm/\">Jenkins Dimensions Plugin</a></p>\n</li>\n<li>\n<p><a href=\"https://plugins.jenkins.io/role-strategy/\">Jenkins Role Strategy</a></p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Supplementary reading</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://www.baeldung.com/ops/jenkins-war-update\">Upgrading Jenkins with a WAR file</a> My initial drafts were based on this process</p>\n</li>\n<li>\n<p><a href=\"https://medium.com/geekculture/how-to-upgrade-jenkins-on-windows-linux-server-b7d4526abc31\">How to Upgrade Jenkins on Windows/Linux Server</a> I used this for Troubleshooting guides tips and tricks</p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n</div>\n</div>"
}